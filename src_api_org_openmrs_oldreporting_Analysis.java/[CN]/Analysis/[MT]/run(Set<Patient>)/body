{
  log.debug("input = " + input);
  DataSet<Patient> data=new SimpleDataSet<Patient>(input);
  for (  DataFilter<Patient> f : patientFilters) {
    data=f.filter(data);
    log.debug("filtered by " + f + " to "+ data);
  }
  for (  DataProducer<Patient> p : producers) {
    p.produceData(data);
    log.debug("produced data with " + p);
  }
  DataTable table=new SimpleDataTable(data);
  if (seriesTransformers != null && seriesTransformers.size() > 0) {
    List<DataSeries> series=new ArrayList<DataSeries>();
    for (    SeriesTransformer trans : seriesTransformers) {
      DataSeries temp=trans.transform(table);
      log.debug("transformed to series with " + trans + " to "+ temp);
      series.add(temp);
    }
    table=SimpleDataTable.fromSeries("",series);
    log.debug("combined series into " + table);
  }
  for (  DataTableGrouper g : groupers) {
    table=g.group(table);
    log.debug("grouped using " + g + " into "+ table);
  }
  if (sorter != null) {
    table.sort(sorter);
    log.debug("sorted with " + sorter + " to "+ table);
  }
  return table;
}
