{
  LocationAttributeType phoneAttrType=new LocationAttributeType();
  phoneAttrType.setName("Facility Phone");
  phoneAttrType.setMinOccurs(0);
  phoneAttrType.setMaxOccurs(1);
  phoneAttrType.setDatatypeClassname("org.openmrs.customdatatype.datatype.FreeTextDatatype");
  Context.getLocationService().saveLocationAttributeType(phoneAttrType);
  LocationAttributeType emailAttrType=new LocationAttributeType();
  emailAttrType.setName("Facility Email");
  emailAttrType.setMinOccurs(0);
  emailAttrType.setMaxOccurs(1);
  emailAttrType.setDatatypeClassname("org.openmrs.customdatatype.datatype.FreeTextDatatype");
  Context.getLocationService().saveLocationAttributeType(emailAttrType);
  Location location1=Context.getLocationService().getLocation(1);
  LocationAttribute la1a=new LocationAttribute();
  la1a.setAttributeType(phoneAttrType);
  la1a.setValue("0123456789");
  location1.addAttribute(la1a);
  LocationAttribute la1b=new LocationAttribute();
  la1b.setAttributeType(emailAttrType);
  la1b.setValue("admin@facility.com");
  location1.addAttribute(la1b);
  Context.getLocationService().saveLocation(location1);
  Location location2=Context.getLocationService().getLocation(2);
  LocationAttribute la2=new LocationAttribute();
  la2.setAttributeType(phoneAttrType);
  la2.setValue("0123456789");
  location2.addAttribute(la2);
  Context.getLocationService().saveLocation(location2);
  Map<LocationAttributeType,Object> attrValues=new HashMap<LocationAttributeType,Object>();
  attrValues.put(phoneAttrType,"0123456789");
  attrValues.put(emailAttrType,"admin@facility.com");
  List<Location> locations=Context.getLocationService().getLocations(null,null,attrValues,false,null,null);
  Assert.assertEquals(1,locations.size());
  Assert.assertEquals(location1,locations.get(0));
}
