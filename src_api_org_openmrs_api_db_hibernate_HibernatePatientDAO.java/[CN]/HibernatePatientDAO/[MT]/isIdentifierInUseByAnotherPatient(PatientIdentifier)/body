{
  boolean checkPatient=patientIdentifier.getPatient() != null && patientIdentifier.getPatient().getPatientId() != null;
  String sql="select count(*) from patient_identifier pi inner join patient p on pi.patient_id = p.patient_id " + "where p.voided = false and pi.voided = false and pi.identifier = :identifier and pi.identifier_type = :idType";
  if (checkPatient) {
    sql+=" and p.patient_id != :ptId";
  }
  SQLQuery query=sessionFactory.getCurrentSession().createSQLQuery(sql);
  query.setString("identifier",patientIdentifier.getIdentifier());
  query.setInteger("idType",patientIdentifier.getIdentifierType().getPatientIdentifierTypeId());
  if (checkPatient) {
    query.setInteger("ptId",patientIdentifier.getPatient().getPatientId());
  }
  return !query.uniqueResult().toString().equals("0");
}
