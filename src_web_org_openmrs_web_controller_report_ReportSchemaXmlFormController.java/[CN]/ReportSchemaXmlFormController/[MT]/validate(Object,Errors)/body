{
  ValidationUtils.rejectIfEmpty(errors,"xml","Paste XML for report before saving");
  ReportSchemaXml rsx=(ReportSchemaXml)commandObject;
  try {
    ReportService reportService=(ReportService)Context.getService(ReportService.class);
    ReportSchema schema=reportService.getReportSchema(rsx);
    if (schema == null)     throw new NullPointerException();
  }
 catch (  Exception ex) {
    log.warn("Exception building ReportSchema from XML",ex);
    if (ex.getCause() != null) {
      Throwable temp=ex.getCause();
      while (temp.getCause() != null) {
        temp=temp.getCause();
      }
      errors.rejectValue("xml",temp.getMessage());
    }
 else {
      StringBuilder sb=new StringBuilder();
      sb.append("Invalid XML content<br/>");
      sb.append(ex).append("<br/>");
      for (      StackTraceElement e : ex.getStackTrace())       sb.append(e.toString()).append("<br/>");
      errors.rejectValue("xml",sb.toString());
    }
  }
}
