{
  if (names == null || names.size() == 0) {
    if (log.isDebugEnabled())     log.debug("there are no names defined for: " + conceptId);
    return null;
  }
  if (log.isDebugEnabled())   log.debug("Getting conceptName for locale: " + locale);
  ConceptName bestMatch=null;
  if (locale == null)   locale=Context.getLocale();
  ConceptNameTag desiredLanguageTag=ConceptNameTag.preferredLanguageTagFor(locale);
  ConceptNameTag desiredCountryTag=ConceptNameTag.preferredCountryTagFor(locale);
  List<ConceptName> compatibleNames=getCompatibleNames(locale);
  if (compatibleNames.size() == 0) {
    Iterator<ConceptName> nameIt=names.iterator();
    bestMatch=nameIt.next();
  }
 else   if (compatibleNames.size() == 1) {
    bestMatch=compatibleNames.get(0);
  }
 else {
    for (    ConceptName possibleName : compatibleNames) {
      if (locale.equals(possibleName.getLocale()) && possibleName.hasTag(ConceptNameTag.PREFERRED)) {
        bestMatch=possibleName;
        break;
      }
      if (desiredCountryTag != null) {
        if (possibleName.hasTag(desiredCountryTag)) {
          bestMatch=possibleName;
          break;
        }
 else         if (possibleName.hasTag(desiredLanguageTag)) {
          bestMatch=possibleName;
        }
 else         if (possibleName.hasTag(ConceptNameTag.PREFERRED)) {
          bestMatch=possibleName;
        }
 else         if (bestMatch == null) {
          bestMatch=possibleName;
        }
      }
 else {
        if (possibleName.hasTag(desiredLanguageTag)) {
          bestMatch=possibleName;
          break;
        }
 else         if (possibleName.hasTag(ConceptNameTag.PREFERRED)) {
          bestMatch=possibleName;
        }
 else         if (bestMatch == null) {
          bestMatch=possibleName;
        }
      }
    }
  }
  if (bestMatch == null) {
    log.warn("No compatible concept name found for for concept id " + conceptId);
  }
  return bestMatch;
}
