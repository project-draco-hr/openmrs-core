{
  if (getNames() == null || names.size() == 0) {
    if (log.isDebugEnabled())     log.debug("there are no names defined for: " + conceptId);
    return null;
  }
  if (log.isDebugEnabled())   log.debug("Getting preferred conceptName for locale: " + forLocale);
  ConceptName preferredName=null;
  if (forLocale == null)   forLocale=Context.getLocale();
  ConceptNameTag desiredLanguageTag=ConceptNameTag.preferredLanguageTagFor(forLocale);
  ConceptNameTag desiredCountryTag=ConceptNameTag.preferredCountryTagFor(forLocale);
  for (  ConceptName possibleName : getCompatibleNames(forLocale)) {
    if (forLocale.equals(possibleName.getLocale()) && possibleName.hasTag(ConceptNameTag.PREFERRED)) {
      preferredName=possibleName;
      break;
    }
    if (desiredCountryTag != null) {
      if (possibleName.hasTag(desiredCountryTag)) {
        preferredName=possibleName;
        break;
      }
    }
 else {
      if (possibleName.hasTag(desiredLanguageTag)) {
        preferredName=possibleName;
        break;
      }
    }
    if ((preferredName == null) && possibleName.hasTag(ConceptNameTag.PREFERRED)) {
      preferredName=possibleName;
    }
  }
  if (log.isDebugEnabled()) {
    if (preferredName == null) {
      log.warn("No preferred concept name found for concept id " + conceptId + " in locale "+ forLocale);
    }
  }
  return preferredName;
}
