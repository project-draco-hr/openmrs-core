{
  try {
    Class dtClass=Context.loadClass(descriptor.getDatatypeClassname());
    CustomDatatype<?> ret=(CustomDatatype<?>)Context.getDatatypeService().getDatatype(dtClass,descriptor.getDatatypeConfig());
    if (ret == null)     throw new CustomDatatypeException("Can't find datatype: " + descriptor.getDatatypeClassname());
    return ret;
  }
 catch (  Exception ex) {
    throw new CustomDatatypeException("Error loading " + descriptor.getDatatypeClassname() + " and configuring it with "+ descriptor.getDatatypeConfig(),ex);
  }
}
