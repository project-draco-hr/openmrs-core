{
  SchedulerService schedulerService=Context.getSchedulerService();
  TaskDefinition t1=new TaskDefinition();
  t1.setId(1);
  t1.setStartOnStartup(false);
  t1.setStartTime(null);
  t1.setTaskClass(ExecutePrintingTask.class.getName());
  t1.setProperty("id","TASK-1");
  t1.setProperty("delay","400");
  t1.setProperty("outputKey","shouldAllowTwoTasksToRunConcurrently");
  t1.setName("name");
  t1.setRepeatInterval(5000l);
  TaskDefinition t2=new TaskDefinition();
  t2.setId(2);
  t2.setStartOnStartup(false);
  t2.setStartTime(null);
  t2.setTaskClass(ExecutePrintingTask.class.getName());
  t2.setProperty("id","TASK-2");
  t2.setProperty("delay","100");
  t2.setProperty("outputKey","shouldAllowTwoTasksToRunConcurrently");
  t2.setName("name");
  t2.setRepeatInterval(5000l);
synchronized (SAVE_TASK_LOCK) {
    schedulerService.scheduleTask(t1);
    Thread.sleep(50);
    schedulerService.scheduleTask(t2);
    Thread.sleep(2500);
    assertEquals("TASK-1, TASK-2, TASK-2, TASK-1",output.get("shouldAllowTwoTasksToRunConcurrently"));
  }
}
