{
  log.debug("Identifier Type: " + typeName);
  Map<Integer,PatientIdentifier> patientIdentifiers;
  if (patientIdentifierMap.containsKey(typeName)) {
    patientIdentifiers=patientIdentifierMap.get(typeName);
  }
 else {
    PatientIdentifierType type=null;
    try {
      Integer id=Integer.valueOf(typeName);
      type=patientService.getPatientIdentifierType(id);
    }
 catch (    NumberFormatException ex) {
    }
    if (type == null) {
      type=patientService.getPatientIdentifierTypeByName(typeName);
    }
    patientIdentifiers=patientSetService.getPatientIdentifiersByType(getPatientSetIfNotAllPatients(),type);
    log.debug("Found identifiers for patient identifier " + type + " = "+ patientIdentifiers);
    patientIdentifierMap.put(typeName,patientIdentifiers);
  }
  return patientIdentifiers.get(patientId);
}
