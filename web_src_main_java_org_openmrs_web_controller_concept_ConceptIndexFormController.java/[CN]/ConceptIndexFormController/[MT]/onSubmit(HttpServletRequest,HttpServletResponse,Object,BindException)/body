{
  HttpSession httpSession=request.getSession();
  String view=getFormView();
  if (Context.isAuthenticated()) {
    String s=request.getParameter("conceptId");
    String successMessageKey;
    if (s != null && !s.equals("")) {
      try {
        s=s.trim();
        if (s.contains("-")) {
          String[] parts=s.split("-");
          String start=parts[0].trim();
          String end=parts[1].trim();
          Context.getConceptService().updateConceptIndexes(Integer.valueOf(start),Integer.valueOf(end));
        }
 else {
          Concept c=Context.getConceptService().getConcept(Integer.valueOf(s));
          if (c != null) {
            log.debug("c.conceptId: " + c.getConceptId());
            Context.getConceptService().updateConceptIndex(c);
          }
        }
      }
 catch (      ArrayIndexOutOfBoundsException aioobe) {
        httpSession.setAttribute(WebConstants.OPENMRS_ERROR_ATTR,"ConceptWord.rangeError");
        return showForm(request,response,errors);
      }
catch (      NumberFormatException nfe) {
        httpSession.setAttribute(WebConstants.OPENMRS_ERROR_ATTR,"ConceptWord.rangeError");
        return showForm(request,response,errors);
      }
      successMessageKey="ConceptWord.updated";
    }
 else {
      Context.getConceptService().updateConceptIndexes();
      successMessageKey="ConceptWord.updateInProgress";
    }
    view=getSuccessView();
    httpSession.setAttribute(WebConstants.OPENMRS_MSG_ATTR,successMessageKey);
  }
  return new ModelAndView(new RedirectView(view));
}
