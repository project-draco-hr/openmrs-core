{
  GlobalProperty gp=new GlobalProperty("test1","test1_value");
  administrationService.saveGlobalProperty(gp);
  HttpServletResponse response=new MockHttpServletResponse();
  MockHttpServletRequest request=new MockHttpServletRequest();
  request.setMethod("POST");
  request.setParameter("action",messageSource.getMessage("general.save",new Object[0],Locale.getDefault()));
  String[] keys=new String[]{"test1","test2"};
  String[] values=new String[]{"test1_new_value","test2_value"};
  String[] descriptions=new String[]{"",""};
  request.setParameter(GlobalPropertyController.PROP_NAME,keys);
  request.setParameter(GlobalPropertyController.PROP_VAL_NAME,values);
  request.setParameter(GlobalPropertyController.PROP_DESC_NAME,descriptions);
  controller.handleRequest(request,response);
  Assert.assertEquals(2,administrationService.getAllGlobalProperties().size());
  for (  GlobalProperty globalProperty : administrationService.getAllGlobalProperties()) {
    if (globalProperty.getProperty().equals("test1")) {
      Assert.assertEquals(globalProperty.getPropertyValue(),"test1_new_value");
    }
 else     if (globalProperty.getProperty().equals("test2")) {
      Assert.assertEquals("test2_value",globalProperty.getPropertyValue());
    }
 else {
      Assert.fail("Should be either test1 or test2");
    }
  }
}
