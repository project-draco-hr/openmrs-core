{
  Patient patient=patientModel.getPatient();
  PersonName personName=patientModel.getPersonName();
  if (personName != null) {
    personName.setPreferred(true);
    patient.addName(personName);
  }
  PersonAddress personAddress=patientModel.getPersonAddress();
  if (personAddress != null) {
    if (personAddress.isVoided() && StringUtils.isBlank(personAddress.getVoidReason())) {
      personAddress.setVoidReason(Context.getMessageSourceService().getMessage("general.default.voidReason"));
    }
 else     if (!(personAddress.isVoided() && personAddress.getPersonAddressId() == null)) {
      personAddress.setPreferred(true);
      patient.addAddress(personAddress);
    }
  }
  if (patientModel.getIdentifiers() != null) {
    for (    PatientIdentifier id : patientModel.getIdentifiers()) {
      if (id.getPatientIdentifierId() == null && id.isVoided())       continue;
      patient.addIdentifier(id);
    }
  }
  if (patientModel.getPersonAttributes() != null) {
    for (    PersonAttribute formAttribute : patientModel.getPersonAttributes()) {
      if (formAttribute.getPersonAttributeId() == null && StringUtils.isBlank(formAttribute.getValue()))       continue;
      if (formAttribute.getPersonAttributeId() != null && !OpenmrsUtil.nullSafeEquals(formAttribute.getValue(),patient.getAttribute(formAttribute.getAttributeType()).getValue())) {
        formAttribute=new PersonAttribute(formAttribute.getAttributeType(),formAttribute.getValue());
        formAttribute.setDateCreated(new Date());
        formAttribute.setCreator(Context.getAuthenticatedUser());
      }
      patient.addAttribute(formAttribute);
    }
  }
  return patient;
}
