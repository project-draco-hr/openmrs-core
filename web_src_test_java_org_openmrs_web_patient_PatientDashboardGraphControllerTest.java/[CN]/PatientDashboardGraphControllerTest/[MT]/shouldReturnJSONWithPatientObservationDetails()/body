{
  executeDataSet("org/openmrs/api/include/ObsServiceTest-initial.xml");
  PatientDashboardGraphController controller=new PatientDashboardGraphController();
  long firstObsDate=new GregorianCalendar(2006,Calendar.FEBRUARY,9).getTimeInMillis();
  long secondObsDate=new GregorianCalendar(2006,Calendar.FEBRUARY,10).getTimeInMillis();
  ModelMap map=new ModelMap();
  controller.showGraphData(2,1,map);
  PatientGraphData graph=(PatientGraphData)map.get("graph");
  String expectedData=String.format("{\"absolute\":{\"high\":50.0,\"low\":2.0},\"critical\":{\"high\":null,\"low\":null},\"name\":\"Some concept name\",\"normal\":{\"high\":null,\"low\":null},\"data\":[[%d,2.0],[%d,1.0]],\"units\":\"\"}",secondObsDate,firstObsDate);
  ObjectMapper mapper=new ObjectMapper();
  JsonNode expectedJson=mapper.readTree(expectedData);
  JsonNode actualJson=mapper.readTree(graph.toString());
  Assert.assertEquals(expectedJson.size(),actualJson.size());
  for (Iterator<String> fieldNames=expectedJson.getFieldNames(); fieldNames.hasNext(); ) {
    String field=fieldNames.next();
    Assert.assertEquals(expectedJson.get(field),actualJson.get(field));
  }
}
