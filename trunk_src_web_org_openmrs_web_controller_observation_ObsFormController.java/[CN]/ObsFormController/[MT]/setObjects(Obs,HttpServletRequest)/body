{
  if (Context.isAuthenticated()) {
    if (obs.getObsId() == null) {
      if (StringUtils.hasText(request.getParameter("personId")))       obs.setPerson(Context.getPatientService().getPatient(Integer.valueOf(request.getParameter("personId"))));
 else       obs.setPerson(null);
      if (StringUtils.hasText(request.getParameter("orderId")))       obs.setOrder(Context.getOrderService().getOrder(Integer.valueOf(request.getParameter("orderId"))));
 else       obs.setOrder(null);
      if (StringUtils.hasText(request.getParameter("conceptId")))       obs.setConcept(Context.getConceptService().getConcept(Integer.valueOf(request.getParameter("conceptId"))));
 else       obs.setConcept(null);
      if (StringUtils.hasText(request.getParameter("encounterId")))       obs.setEncounter(Context.getEncounterService().getEncounter(Integer.valueOf(request.getParameter("encounterId"))));
 else       obs.setEncounter(null);
    }
    if (StringUtils.hasText(request.getParameter("valueCodedId")))     obs.setValueCoded(Context.getConceptService().getConcept(Integer.valueOf(request.getParameter("valueCodedId"))));
 else     obs.setValueCoded(null);
    if (StringUtils.hasText(request.getParameter("valueDrugId")))     obs.setValueDrug(Context.getConceptService().getDrug(Integer.valueOf(request.getParameter("valueDrugId"))));
 else     obs.setValueDrug(null);
  }
  return obs;
}
