{
  Map<Integer,Map<String,Object>> ret=new HashMap<Integer,Map<String,Object>>();
  Collection<Integer> ids=patients.getPatientIds();
  Query query=sessionFactory.getCurrentSession().createQuery("select patient.personId, patient.gender, patient.birthdate from Patient patient");
  query.setCacheMode(CacheMode.IGNORE);
  List<Object[]> temp=query.list();
  long now=System.currentTimeMillis();
  for (  Object[] results : temp) {
    Integer patientId=(Integer)results[0];
    if (!ids.contains(patientId)) {
      continue;
    }
    Map<String,Object> holder=new HashMap<String,Object>();
    holder.put("gender",results[1]);
    Date bd=(Date)results[2];
    if (bd != null) {
      int age=(int)((now - bd.getTime()) / MS_PER_YEAR);
      holder.put("age_years",age);
      holder.put("birthdate",bd);
    }
    ret.put(patientId,holder);
  }
  return ret;
}
