{
  ObsService os=Context.getObsService();
  ObsFormController controller=new ObsFormController();
  controller.setApplicationContext(applicationContext);
  controller.setSuccessView("encounter.form");
  controller.setFormView("obs.form");
  MockHttpServletRequest request=new MockHttpServletRequest("GET","/admin/observations/obs.form");
  request.setSession(new MockHttpSession(null));
  HttpServletResponse response=new MockHttpServletResponse();
  controller.handleRequest(request,response);
  request.setMethod("POST");
  request.addParameter("person","2");
  request.addParameter("encounter","3");
  request.addParameter("location","1");
  request.addParameter("obsDatetime","05/05/2005");
  request.addParameter("conceptName","2457");
  request.addParameter("valueCoded","5");
  request.addParameter("saveObs","Save Obs");
  ModelAndView mav=controller.handleRequest(request,response);
  TestUtil.printOutTableContents(getConnection(),"obs");
  List<Obs> obsForPatient=os.getObservationsByPerson(new Person(2));
  assertEquals(1,obsForPatient.size());
  assertEquals(new Encounter(3),obsForPatient.get(0).getEncounter());
  assertEquals(new Location(1),obsForPatient.get(0).getLocation());
}
