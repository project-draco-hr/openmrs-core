{
  Collection<Role> roles=user.getAllRoles();
  for (  Role r : roles) {
    for (    Privilege p : r.getPrivileges())     if (!user.hasPrivilege(p.getPrivilege()))     throw new APIAuthenticationException("Privilege required: " + p);
  }
}
