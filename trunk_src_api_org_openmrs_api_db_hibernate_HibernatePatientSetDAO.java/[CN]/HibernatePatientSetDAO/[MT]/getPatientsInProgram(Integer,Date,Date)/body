{
  String sql="select patient_id from patient_program pp where pp.voided = false and pp.program_id = :programId ";
  if (fromDate != null)   sql+=" and (date_completed is null or date_completed >= :fromDate) ";
  if (toDate != null)   sql+=" and (date_enrolled is null or date_enrolled <= :toDate) ";
  log.debug("sql: " + sql);
  Query query=sessionFactory.getCurrentSession().createSQLQuery(sql);
  query.setCacheMode(CacheMode.IGNORE);
  query.setInteger("programId",programId);
  if (fromDate != null)   query.setDate("fromDate",fromDate);
  if (toDate != null)   query.setDate("toDate",toDate);
  return new Cohort(query.list());
}
