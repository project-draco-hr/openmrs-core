{
  if (operator == BooleanOperator.AND) {
    Cohort temp=input;
    for (    PatientFilter pf : filters) {
      temp=pf.filter(temp,context);
    }
    return temp;
  }
 else {
    Set<Integer> ptIds=new HashSet<Integer>();
    for (    PatientFilter pf : filters) {
      ptIds.addAll(pf.filter(input,context).getMemberIds());
      log.debug("or " + pf.getName() + " ("+ pf.toString()+ ")");
    }
    Cohort ret=new Cohort();
    ret.setMemberIds(ptIds);
    return ret;
  }
}
