{
  ResourcePatternResolver resourcePatternResolver=new PathMatchingResourcePatternResolver();
  MetadataReaderFactory metadataReaderFactory=new CachingMetadataReaderFactory(resourcePatternResolver);
  String packageSearchPath=ResourcePatternResolver.CLASSPATH_ALL_URL_PREFIX + resolveBasePackage(OPENMRS_DWR_PACKAGE_NAME) + "/**/*Service.class";
  List<String> candidateClasses=new ArrayList<String>();
  Resource[] resources=resourcePatternResolver.getResources(packageSearchPath);
  for (  Resource resource : resources) {
    if (resource.isReadable()) {
      MetadataReader metadataReader=metadataReaderFactory.getMetadataReader(resource);
      if (doesClassContainDeprecatedAnnotation(metadataReader)) {
        candidateClasses.add(metadataReader.getClassMetadata().getClassName());
      }
    }
  }
  return candidateClasses;
}
