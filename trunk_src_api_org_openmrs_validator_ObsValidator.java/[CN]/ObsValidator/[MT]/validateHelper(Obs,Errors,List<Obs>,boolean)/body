{
  if (obs.getPersonId() == null && obs.getPersonId() == null)   errors.rejectValue("person","error.null");
  Concept c=obs.getConcept();
  if (c == null) {
    errors.rejectValue("concept","error.null");
  }
 else {
    ConceptDatatype dt=c.getDatatype();
    if (dt.isBoolean() && obs.getValueAsBoolean() == null) {
      if (atRootNode)       errors.rejectValue("valueNumeric","error.null");
 else       errors.rejectValue("groupMembers","Obs.error.inGroupMember");
    }
 else     if (dt.isCoded() && obs.getValueCoded() == null) {
      if (atRootNode)       errors.rejectValue("valueCoded","error.null");
 else       errors.rejectValue("groupMembers","Obs.error.inGroupMember");
    }
 else     if (dt.isDate() && obs.getValueDatetime() == null) {
      if (atRootNode)       errors.rejectValue("valueDatetime","error.null");
 else       errors.rejectValue("groupMembers","Obs.error.inGroupMember");
    }
 else     if (dt.isNumeric() && obs.getValueNumeric() == null) {
      if (atRootNode)       errors.rejectValue("valueNumeric","error.null");
 else       errors.rejectValue("groupMembers","Obs.error.inGroupMember");
    }
 else     if (dt.isText() && obs.getValueText() == null) {
      if (atRootNode)       errors.rejectValue("valueText","error.null");
 else       errors.rejectValue("groupMembers","Obs.error.inGroupMember");
    }
  }
  if (errors.hasErrors())   return;
  if (ancestors.contains(obs))   errors.rejectValue("groupMembers","Obs.error.groupContainsItself");
  if (obs.isObsGrouping()) {
    System.out.println("all children = " + obs.getGroupMembers());
    ancestors.add(obs);
    for (    Obs child : obs.getGroupMembers()) {
      System.out.println("\tchild=" + child);
      validateHelper(child,errors,ancestors,false);
    }
    ancestors.remove(ancestors.size() - 1);
  }
}
