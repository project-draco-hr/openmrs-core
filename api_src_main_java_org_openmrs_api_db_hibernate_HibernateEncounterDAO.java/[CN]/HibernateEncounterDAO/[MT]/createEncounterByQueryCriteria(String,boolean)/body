{
  Criteria criteria=sessionFactory.getCurrentSession().createCriteria(Encounter.class);
  if (!includeVoided)   criteria.add(Restrictions.eq("voided",false));
  criteria=criteria.createCriteria("patient","pat");
  String name=null;
  String identifier=null;
  if (query.matches(".*\\d+.*")) {
    identifier=query;
  }
 else {
    name=query;
  }
  criteria=new PatientSearchCriteria(sessionFactory,criteria).prepareCriteria(name,identifier,new ArrayList<PatientIdentifierType>(),false,true);
  return criteria;
}
