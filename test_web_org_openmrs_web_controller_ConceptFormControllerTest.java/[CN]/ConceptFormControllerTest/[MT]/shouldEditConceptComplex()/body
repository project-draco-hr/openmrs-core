{
  executeDataSet("org/openmrs/api/include/ObsServiceTest-complex.xml");
  ConceptService cs=Context.getConceptService();
  ConceptFormController conceptFormController=(ConceptFormController)applicationContext.getBean("conceptForm");
  MockHttpServletRequest mockRequest=new MockHttpServletRequest();
  mockRequest.setMethod("POST");
  mockRequest.setParameter("action","");
  mockRequest.setParameter("conceptId","8473");
  mockRequest.setParameter("namesByLocale[en].name","A complex concept");
  mockRequest.setParameter("concept.datatype","13");
  mockRequest.setParameter("concept.class","5");
  mockRequest.setParameter("handlerKey","TextHandler");
  ModelAndView mav=conceptFormController.handleRequest(mockRequest,new MockHttpServletResponse());
  assertNotNull(mav);
  assertTrue(mav.getModel().isEmpty());
  Concept concept=cs.getConcept(8473);
  assertEquals(ConceptComplex.class,concept.getClass());
  ConceptComplex complex=(ConceptComplex)concept;
  assertEquals("TextHandler",complex.getHandler());
}
