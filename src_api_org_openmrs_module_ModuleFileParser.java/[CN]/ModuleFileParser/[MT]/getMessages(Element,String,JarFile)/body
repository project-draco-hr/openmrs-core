{
  Map<String,Properties> messages=new HashMap<String,Properties>();
  NodeList messageNodes=root.getElementsByTagName("messages");
  if (messageNodes.getLength() > 0) {
    log.debug("# message nodes: " + messageNodes.getLength());
    int i=0;
    while (i < messageNodes.getLength()) {
      Node node=messageNodes.item(i);
      NodeList nodes=node.getChildNodes();
      int x=0;
      String lang="", file="";
      while (x < nodes.getLength()) {
        Node childNode=nodes.item(x);
        if ("lang".equals(childNode.getNodeName()))         lang=childNode.getTextContent();
 else         if ("file".equals(childNode.getNodeName()))         file=childNode.getTextContent();
        x++;
      }
      log.debug("lang: " + lang + " file: "+ file);
      if (lang.length() > 0 && file.length() > 0) {
        InputStream inStream=null;
        try {
          ZipEntry entry=jarfile.getEntry(file);
          if (entry == null)           throw new ModuleException("No message properties file '" + file + "' for language '"+ lang+ "'");
          inStream=jarfile.getInputStream(entry);
          Properties props=new Properties();
          OpenmrsUtil.loadProperties(props,inStream);
          messages.put(lang,props);
        }
 catch (        IOException e) {
          log.warn("Unable to load properties: " + file);
        }
 finally {
          if (inStream != null) {
            try {
              inStream.close();
            }
 catch (            IOException io) {
              log.error("Error while closing property input stream for module: " + moduleFile.getAbsolutePath(),io);
            }
          }
        }
      }
 else       log.warn("'lang' and 'file' are required for extensions. Given '" + lang + "' and '"+ file+ "'");
      i++;
    }
  }
  return messages;
}
