{
  Set<Integer> tasks=new HashSet<Integer>();
  for (  TaskConfig task : getScheduledTasks()) {
    tasks.add(task.getId());
    try {
      stopTask(task);
    }
 catch (    Exception e) {
      log.debug("Unable to stop task while saving memento " + task.getName(),e);
    }
  }
  TimerSchedulerMemento memento=new TimerSchedulerMemento(tasks);
  memento.saveErrorTasks();
  return memento;
}
