{
  StringBuilder sb=new StringBuilder();
  if (conceptId != null)   concept=Context.getConceptService().getConcept(conceptId);
  if (concept != null) {
    if (concept.getName() != null)     sb.append(concept.getName().getName());
  }
  if (obsValue != null)   sb.append(obsValue.getValueAsString(Context.getLocale()));
  if (userId != null)   user=Context.getUserService().getUser(userId);
  if (user != null)   printUser(sb,user);
  if (personId != null)   person=Context.getPersonService().getPerson(personId);
  if (person != null)   printPerson(sb,person);
  if (encounterId != null)   encounter=Context.getEncounterService().getEncounter(encounterId);
  if (encounter != null) {
    printMetadata(sb,encounter.getEncounterType());
    sb.append(" @");
    printMetadata(sb,encounter.getLocation());
    sb.append(" | ");
    printDate(sb,encounter.getEncounterDatetime());
    sb.append(" | ");
    printPerson(sb,encounter.getProvider());
  }
  if (encounterTypeId != null)   encounterType=Context.getEncounterService().getEncounterType(encounterTypeId);
  if (encounterType != null) {
    printMetadata(sb,encounterType);
  }
  if (locationId != null)   location=Context.getLocationService().getLocation(locationId);
  if (location != null) {
    printMetadata(sb,location);
  }
  if (locationTagId != null)   locationTag=Context.getLocationService().getLocationTag(locationTagId);
  if (locationTag != null) {
    printMetadata(sb,locationTag);
  }
  if (StringUtils.hasText(var)) {
    pageContext.setAttribute(var,sb.toString());
  }
 else {
    try {
      pageContext.getOut().write(sb.toString());
    }
 catch (    IOException e) {
      log.error("Failed to write to pageContext.getOut()",e);
    }
  }
  return SKIP_BODY;
}
