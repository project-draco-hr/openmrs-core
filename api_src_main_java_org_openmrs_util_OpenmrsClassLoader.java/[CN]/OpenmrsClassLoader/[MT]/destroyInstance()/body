{
  ThreadGroup rootGroup=Thread.currentThread().getThreadGroup();
  ThreadGroup parent;
  while ((parent=rootGroup.getParent()) != null) {
    rootGroup=parent;
  }
  List<Thread> threads=listThreads(rootGroup,"");
  for (  Thread thread : threads) {
    if (thread.getContextClassLoader() != null) {
      log.debug("context classloader on thread: " + thread.getName() + " is: "+ thread.getContextClassLoader().getClass().getName()+ ":"+ thread.getContextClassLoader().hashCode());
      if (thread.getContextClassLoader() == OpenmrsClassLoaderHolder.INSTANCE) {
        thread.setContextClassLoader(OpenmrsClassLoaderHolder.INSTANCE.getParent());
        log.debug("Cleared context classloader to save the world from memory leaks");
      }
    }
  }
  OpenmrsClassLoaderHolder.INSTANCE=null;
}
