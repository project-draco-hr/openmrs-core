{
  User authUser=Context.getAuthenticatedUser();
  Date timestamp=new Date();
  if (concept.getCreator() == null)   concept.setCreator(authUser);
  if (concept.getDateCreated() == null)   concept.setDateCreated(timestamp);
  if (concept.getConceptId() != null) {
    concept.setChangedBy(authUser);
    concept.setDateChanged(timestamp);
  }
  if (concept.getNames() != null) {
    for (    ConceptName cn : concept.getNames()) {
      if (cn.getCreator() == null)       cn.setCreator(authUser);
      if (cn.getDateCreated() == null)       cn.setDateCreated(timestamp);
      cn.setConcept(concept);
      if (cn.getTags() != null) {
        for (        ConceptNameTag tag : cn.getTags()) {
          if (tag.getConceptNameTagId() == null) {
            ConceptNameTag possibleReplacementTag=getConceptNameTagByName(tag.getTag());
            if (possibleReplacementTag != null) {
              cn.removeTag(tag);
              cn.addTag(possibleReplacementTag);
            }
          }
          if (tag.getCreator() == null)           tag.setCreator(authUser);
          if (tag.getDateCreated() == null)           tag.setDateCreated(timestamp);
        }
      }
      if (cn.isVoided()) {
        if (cn.getVoidedBy() == null)         cn.setVoidedBy(authUser);
        if (cn.getDateVoided() == null)         cn.setDateVoided(timestamp);
      }
 else {
        cn.setVoidReason(null);
        cn.setDateVoided(null);
        cn.setVoidedBy(null);
      }
    }
  }
  if (concept.getConceptSets() != null) {
    for (    ConceptSet set : concept.getConceptSets()) {
      if (set.getCreator() == null)       set.setCreator(authUser);
      if (set.getDateCreated() == null)       set.setDateCreated(timestamp);
      set.setConceptSet(concept);
    }
  }
  if (concept.getAnswers(true) != null) {
    for (    ConceptAnswer ca : concept.getAnswers(true)) {
      if (ca.getCreator() == null)       ca.setCreator(authUser);
      if (ca.getDateCreated() == null)       ca.setDateCreated(timestamp);
      ca.setConcept(concept);
    }
  }
  if (concept.getDescriptions() != null) {
    for (    ConceptDescription cd : concept.getDescriptions()) {
      if (cd.getCreator() == null)       cd.setCreator(authUser);
      if (cd.getDateCreated() == null)       cd.setDateCreated(timestamp);
      cd.setConcept(concept);
    }
  }
  if (concept.getConceptMappings() != null) {
    for (    ConceptMap map : concept.getConceptMappings()) {
      if (map.getCreator() == null)       map.setCreator(authUser);
      if (map.getDateCreated() == null)       map.setDateCreated(timestamp);
      map.setConcept(concept);
    }
  }
}
