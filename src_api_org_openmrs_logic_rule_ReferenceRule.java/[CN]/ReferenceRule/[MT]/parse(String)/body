{
  log.info("Parsing reference string " + reference);
  int firstDotIndex=reference.indexOf('.');
  if (firstDotIndex == -1)   throw new InvalidReferenceRuleException("Missing dot notation");
  if (firstDotIndex < 1)   throw new InvalidReferenceRuleException("References cannot start with a period");
  if (firstDotIndex >= reference.length() - 1)   throw new InvalidReferenceRuleException("Missing key name following period; expecting 'datasource.key'");
  String dataSourceName=reference.substring(0,firstDotIndex);
  key=reference.substring(firstDotIndex + 1);
  dataSource=Context.getLogicService().getLogicDataSource(dataSourceName);
  if (dataSource == null)   throw new InvalidReferenceRuleException("Invalid logic data source: " + dataSourceName);
  if (!dataSource.hasKey(key))   throw new InvalidReferenceRuleException("Invalid key (" + key + ") for LogicDataSource ("+ dataSourceName+ ")");
}
