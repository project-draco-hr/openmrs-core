{
  Integer ptId;
  try {
    ptId=context.getHL7Service().resolvePatientId(pid);
  }
 catch (  HL7Exception ex) {
    throw new HL7Exception("Error retrieving patient from PID segment",ex);
  }
  if (ptId == null) {
    throw new HL7Exception("Could not find patient specified in PID segment");
  }
 else {
    return context.getPatientService().getPatient(ptId);
  }
}
