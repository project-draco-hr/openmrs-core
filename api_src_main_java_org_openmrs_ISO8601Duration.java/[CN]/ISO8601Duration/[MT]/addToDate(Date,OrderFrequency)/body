{
  if (SECONDS_CODE.equals(code))   return DateUtils.addSeconds(startDate,duration);
  if (MINUTES_CODE.equals(code))   return DateUtils.addMinutes(startDate,duration);
  if (HOURS_CODE.equals(code))   return DateUtils.addHours(startDate,duration);
  if (DAYS_CODE.equals(code))   return DateUtils.addDays(startDate,duration);
  if (WEEKS_CODE.equals(code))   return DateUtils.addWeeks(startDate,duration);
  if (MONTHS_CODE.equals(code))   return DateUtils.addMonths(startDate,duration);
  if (YEARS_CODE.equals(code))   return DateUtils.addYears(startDate,duration);
  if (RECURRING_INTERVAL_CODE.equals(code)) {
    if (frequency == null)     throw new APIException("Frequency can not be null when duration in Recurring Interval");
    return DateUtils.addSeconds(startDate,(int)(duration * SECONDS_PER_DAY / frequency.getFrequencyPerDay()));
  }
  throw new APIException(String.format("Unknown code '%s' for ISO8601 duration units",code));
}
