{
  Patient preferred=patientService.getPatient(7);
  Patient notPreferred=patientService.getPatient(8);
  patientService.mergePatients(preferred,notPreferred);
  PatientIdentifier nonvoidedPI=new PatientIdentifier("7TU-8",new PatientIdentifierType(1),new Location(1));
  nonvoidedPI.setPatient(preferred);
  PatientIdentifier voidedPI=new PatientIdentifier("ABC123",new PatientIdentifierType(2),new Location(1));
  voidedPI.setPatient(preferred);
  boolean containsNonVoidedPI=false;
  for (  PatientIdentifier id : preferred.getIdentifiers()) {
    if (id.equalsContent(nonvoidedPI))     containsNonVoidedPI=true;
  }
  Assert.assertTrue(containsNonVoidedPI);
  Assert.assertFalse("The voided identifier: " + voidedPI + " should not have been moved over because it was voided",OpenmrsUtil.collectionContains(preferred.getIdentifiers(),voidedPI));
}
