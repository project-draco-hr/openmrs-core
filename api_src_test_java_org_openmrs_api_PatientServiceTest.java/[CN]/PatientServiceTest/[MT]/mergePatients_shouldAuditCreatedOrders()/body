{
  Patient preferred=patientService.getPatient(999);
  Patient notPreferred=patientService.getPatient(2);
  List<Patient> notPreferredPatients=new ArrayList<Patient>();
  notPreferredPatients.add(notPreferred);
  Order order=Context.getOrderService().getOrders(null,notPreferredPatients,null,null,null).get(0);
  PersonMergeLog audit=mergeAndRetrieveAudit(preferred,notPreferred);
  String addedOrderUuid=null;
  List<Patient> preferredPatients=new ArrayList<Patient>();
  preferredPatients.add(preferred);
  List<Order> orders=Context.getOrderService().getOrders(null,preferredPatients,null,null,null);
  for (  Order o : orders) {
    if (o.getInstructions().equals(order.getInstructions())) {
      addedOrderUuid=o.getUuid();
    }
  }
  Assert.assertNotNull("expected new order was not found for the preferred patient after the merge",addedOrderUuid);
  Assert.assertTrue("order creation not audited",isValueInList(addedOrderUuid,audit.getPersonMergeLogData().getCreatedOrders()));
}
