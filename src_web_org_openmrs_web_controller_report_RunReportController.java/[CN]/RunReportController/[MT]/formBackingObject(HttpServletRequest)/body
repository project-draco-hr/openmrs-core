{
  CommandObject ret=new CommandObject();
  if (Context.isAuthenticated()) {
    Integer id=Integer.valueOf(request.getParameter("reportId"));
    ReportService reportService=(ReportService)Context.getService(ReportService.class);
    ReportSchema schema=reportService.getReportSchema(id);
    ret.setSchema(schema);
    ret.setRenderingModes(reportService.getRenderingModes(schema));
    String commaSeparated=request.getParameter("patientIds");
    String cohortName=request.getParameter("cohortName");
    if (commaSeparated != null) {
      try {
        Cohort inputCohort=new Cohort(commaSeparated);
        if (cohortName != null)         inputCohort.setName(cohortName);
        ret.setInputCohort(inputCohort);
      }
 catch (      Exception ex) {
      }
    }
  }
  return ret;
}
