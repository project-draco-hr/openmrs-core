{
  PatientService ps=Context.getPatientService();
  List<Patient> patients=ps.getPatients("John");
  assertTrue(patients.isEmpty());
  NewPatientFormController controller=new NewPatientFormController();
  controller.setApplicationContext(applicationContext);
  controller.setSuccessView("patientDashboard.form");
  MockHttpServletRequest request=new MockHttpServletRequest();
  HttpServletResponse response=new MockHttpServletResponse();
  request.setMethod("POST");
  request.addParameter("name.givenName","John");
  request.addParameter("name.familyName","Doe");
  request.addParameter("identifier","123");
  request.addParameter("identifierType","1");
  request.addParameter("location","1");
  request.addParameter("preferred","1");
  request.addParameter("gender","M");
  request.addParameter("birthdate","05/05/1959");
  request.addParameter("birthdateEstimated","0");
  request.addParameter("tribe","");
  request.addParameter("address.address1","1234 Somewhere Street");
  request.addParameter("1","");
  ModelAndView modelAndView=controller.handleRequest(request,response);
  assertEquals(RedirectView.class,modelAndView.getView().getClass());
  RedirectView redirectView=(RedirectView)modelAndView.getView();
  assertTrue(redirectView.getUrl().startsWith("patientDashboard.form"));
  patients=ps.getPatients("John");
  assertFalse(patients.isEmpty());
}
