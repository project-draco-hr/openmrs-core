{
  CustomValueDescriptor descriptor=val.getDescriptor();
  CustomDatatype<?> datatype=CustomDatatypeUtil.getDatatype(descriptor);
  CustomDatatypeHandler handler=CustomDatatypeUtil.getHandler(descriptor);
  if (view == null)   view=CustomDatatype.VIEW_DEFAULT;
  if (handler != null) {
    sb.append(handler.render(datatype,val.getValueReference(),view));
  }
 else   if (datatype != null) {
    sb.append(datatype.render(val.getValueReference(),view));
  }
 else {
    sb.append(val.getValueReference());
  }
}
