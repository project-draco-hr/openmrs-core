{
  Class<?> callerClass=new OpenmrsSecurityManager().getCallerClass(0);
  if (!TimerSchedulerTask.class.isAssignableFrom(callerClass))   throw new APIException("This method can only be called from the TimerSchedulerTask class, not " + callerClass.getName());
  DaemonThread executeTaskThread=new DaemonThread(){
    @Override public void run(){
      isDaemonThread.set(true);
      try {
        Context.openSession();
        task.execute();
      }
 catch (      Throwable t) {
        exceptionThrown=t;
      }
 finally {
        Context.closeSession();
      }
    }
  }
;
  executeTaskThread.start();
  try {
    executeTaskThread.join();
  }
 catch (  InterruptedException e) {
  }
  if (executeTaskThread.exceptionThrown != null)   throw executeTaskThread.exceptionThrown;
}
