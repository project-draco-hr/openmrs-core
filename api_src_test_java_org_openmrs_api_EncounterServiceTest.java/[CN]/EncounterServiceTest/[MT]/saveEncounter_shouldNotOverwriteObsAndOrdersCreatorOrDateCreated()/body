{
  EncounterService encounterService=Context.getEncounterService();
  Encounter encounter=buildEncounter();
  Date date=new Date(System.currentTimeMillis() - 5000);
  encounter.setDateCreated(date);
  User creator=new User(1);
  encounter.setCreator(creator);
  ConceptService cs=Context.getConceptService();
  Obs obs=new Obs(new Patient(2),cs.getConcept(1),new Date(),new Location(1));
  obs.setDateCreated(date);
  obs.setCreator(creator);
  encounter.addObs(obs);
  OrderService os=Context.getOrderService();
  TestOrder order=new TestOrder();
  order.setConcept(Context.getConceptService().getConcept(5497));
  order.setPatient(new Patient(2));
  order.setDateActivated(new Date());
  order.setOrderType(os.getOrderType(2));
  order.setOrderer(Context.getProviderService().getProvider(1));
  Field field=Order.class.getDeclaredField("orderNumber");
  field.setAccessible(true);
  field.set(order,"ORD-1");
  order.setDateCreated(date);
  order.setCreator(creator);
  order.setCareSetting(os.getCareSetting(1));
  encounter.addOrder(order);
  assertNotSame(encounter.getCreator(),Context.getAuthenticatedUser());
  encounterService.saveEncounter(encounter);
  Obs createdObs=Context.getObsService().getObs(obs.getObsId());
  assertEquals(DateUtil.truncateToSeconds(date),createdObs.getDateCreated());
  assertEquals(creator,createdObs.getCreator());
  Order createdOrder=os.getOrder(order.getOrderId());
  assertEquals(DateUtil.truncateToSeconds(date),createdOrder.getDateCreated());
  assertEquals(creator,createdOrder.getCreator());
}
