{
  executeDataSet(PROGRAM_NEXT_STATES_XML);
  Integer patient=11;
  Integer workflow=501;
  Vector<ListItem> possibleNextStates;
  PatientProgram pp=Context.getProgramWorkflowService().getPatientProgram(patient);
  ProgramWorkflow pw=pp.getProgram().getWorkflow(workflow);
  Set<ProgramWorkflowState> pwss=pw.getStates();
  for (  ProgramWorkflowState pws : pwss) {
    Concept cp=pws.getConcept();
    ConceptName cn=cp.getName();
    if (cn != null) {
      String cnn=cn.getName();
      if (cnn.equalsIgnoreCase("Test State 3")) {
        pws.setRetired(true);
      }
    }
  }
  possibleNextStates=dwrProgramWorkflowService.getPossibleNextStates(patient,workflow);
  assertFalse(possibleNextStates.isEmpty());
  assertEquals(2,possibleNextStates.size());
}
