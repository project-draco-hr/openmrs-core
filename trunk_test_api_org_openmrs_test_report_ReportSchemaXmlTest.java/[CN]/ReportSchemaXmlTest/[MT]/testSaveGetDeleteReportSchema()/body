{
  StringBuilder xml=new StringBuilder();
  xml.append("<reportSchema id=\"1\" reportSchemaId=\"1\">\n");
  xml.append("    <name>PEPFAR report</name>\n");
  xml.append("	<description>\n");
  xml.append("		Sample monthly PEPFAR report, modeled after the lesotho one\n");
  xml.append("	</description>\n");
  xml.append("	<parameters class=\"java.util.ArrayList\">\n");
  xml.append("		<parameter clazz=\"java.util.Date\"><name>report.startDate</name><label>When does the report period start?</label></parameter>/>\n");
  xml.append("		<parameter clazz=\"java.util.Date\"><name>report.endDate</name><label>When does the report period end?</label></parameter>\n");
  xml.append("		<parameter clazz=\"org.openmrs.Location\"><name>report.location</name><label>For which clinic is this report?</label></parameter>\n");
  xml.append("	</parameters>\n");
  xml.append("	<dataSets class=\"java.util.ArrayList\">\n");
  xml.append("		<dataSetDefinition class=\"org.openmrs.dataset.CohortDataSetDefinition\" name=\"Cohorts\">\n");
  xml.append("			<strategies class=\"java.util.LinkedHashMap\">\n");
  xml.append("				<entry>\n");
  xml.append("					<string>1.a</string>\n");
  xml.append("					<cohort class=\"org.openmrs.reporting.PatientSearch\">\n");
  xml.append("						<specification>[Male]</specification>\n");
  xml.append("					</cohort>\n");
  xml.append("				</entry>\n");
  xml.append("				<entry>\n");
  xml.append("					<string>1.b</string>\n");
  xml.append("					<cohort class=\"org.openmrs.reporting.PatientSearch\">\n");
  xml.append("						<specification>[Male] and [Adult] and [EnrolledOnDate|untilDate=${report.startDate - 1d}]</specification>\n");
  xml.append("					</cohort>\n");
  xml.append("				</entry>\n");
  xml.append("			</strategies>\n");
  xml.append("		</dataSetDefinition>\n");
  xml.append("	</dataSets>\n");
  xml.append("</reportSchema>\n");
  ReportSchemaXml reportSchemaXml=new ReportSchemaXml();
  reportSchemaXml.setXml(xml.toString());
  assertEquals(xml.toString(),reportSchemaXml.getXml());
  ReportService rs=(ReportService)Context.getService(ReportService.class);
  rs.createReportSchemaXml(reportSchemaXml);
  Context.clearSession();
  ReportSchemaXml reportSchemaXmlFromDB=rs.getReportSchemaXml(1);
  assertNotNull("The schema xml was not saved correctly, none found in the db",reportSchemaXmlFromDB);
  assertEquals(xml.toString(),reportSchemaXmlFromDB.getXml());
  assertEquals(new Integer(1),reportSchemaXmlFromDB.getReportSchemaId());
  rs.deleteReportSchemaXml(reportSchemaXmlFromDB);
  ReportSchemaXml deletedXml=rs.getReportSchemaXml(1);
  assertNull("The deleted xml object should be null",deletedXml);
}
