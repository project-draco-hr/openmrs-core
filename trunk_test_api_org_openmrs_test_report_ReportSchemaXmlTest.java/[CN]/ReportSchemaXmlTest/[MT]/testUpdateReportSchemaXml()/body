{
  StringBuilder xml=new StringBuilder();
  xml.append("<reportSchema id=\"2\" reportSchemaId=\"2\">\n");
  xml.append("    <name>PEPFAR report</name>\n");
  xml.append("	<description>\n");
  xml.append("		Sample monthly PEPFAR report, modeled after the lesotho one\n");
  xml.append("	</description>\n");
  xml.append("	<parameters class=\"java.util.ArrayList\">\n");
  xml.append("		<parameter clazz=\"java.util.Date\"><name>report.startDate</name><label>When does the report period start?</label></parameter>/>\n");
  xml.append("		<parameter clazz=\"java.util.Date\"><name>report.endDate</name><label>When does the report period end?</label></parameter>\n");
  xml.append("		<parameter clazz=\"org.openmrs.Location\"><name>report.location</name><label>For which clinic is this report?</label></parameter>\n");
  xml.append("	</parameters>\n");
  xml.append("	<dataSets class=\"java.util.ArrayList\">\n");
  xml.append("		<dataSetDefinition class=\"org.openmrs.dataset.CohortDataSetDefinition\" name=\"Cohorts\">\n");
  xml.append("			<strategies class=\"java.util.LinkedHashMap\">\n");
  xml.append("				<entry>\n");
  xml.append("					<string>1.a</string>\n");
  xml.append("					<cohort class=\"org.openmrs.reporting.PatientSearch\">\n");
  xml.append("						<specification>[Male]</specification>\n");
  xml.append("					</cohort>\n");
  xml.append("				</entry>\n");
  xml.append("				<entry>\n");
  xml.append("					<string>1.b</string>\n");
  xml.append("					<cohort class=\"org.openmrs.reporting.PatientSearch\">\n");
  xml.append("						<specification>[Male] and [Adult]</specification>\n");
  xml.append("					</cohort>\n");
  xml.append("				</entry>\n");
  xml.append("			</strategies>\n");
  xml.append("		</dataSetDefinition>\n");
  xml.append("	</dataSets>\n");
  xml.append("</reportSchema>\n");
  ReportSchemaXml reportSchemaXml=new ReportSchemaXml();
  reportSchemaXml.setXml(xml.toString());
  assertEquals(xml.toString(),reportSchemaXml.getXml());
  ReportService rs=(ReportService)Context.getService(ReportService.class);
  rs.updateReportSchemaXml(reportSchemaXml);
  ReportSchemaXml reportSchemaXmlFromDB=rs.getReportSchemaXml(2);
  ReportSchemaXml reportSchemaXmlJodion=rs.getReportSchemaXml(2);
  assertEquals(xml.toString(),reportSchemaXmlFromDB.getXml());
  StringBuilder xml2=new StringBuilder();
  xml2.append("<reportSchema id=\"2\" reportSchemaId=\"2\">\n");
  xml2.append("    <name>PEPFAR report updated</name>\n");
  xml2.append("	<description>\n");
  xml2.append("		Sample monthly PEPFAR report changed again\n");
  xml2.append("	</description>\n");
  xml2.append("	<parameters class=\"java.util.ArrayList\">\n");
  xml2.append("		<parameter clazz=\"java.util.Date\"><name>report.startDate</name><label>When does the report period start?</label></parameter>/>\n");
  xml2.append("		<parameter clazz=\"java.util.Date\"><name>report.endDate</name><label>When does the report period end?</label></parameter>\n");
  xml2.append("		<parameter clazz=\"org.openmrs.Location\"><name>report.location</name><label>For which clinic is this report?</label></parameter>\n");
  xml2.append("	</parameters>\n");
  xml2.append("	<dataSets class=\"java.util.ArrayList\">\n");
  xml2.append("		<dataSetDefinition class=\"org.openmrs.dataset.CohortDataSetDefinition\" name=\"Cohorts\">\n");
  xml2.append("			<strategies class=\"java.util.LinkedHashMap\">\n");
  xml2.append("				<entry>\n");
  xml2.append("					<string>1.a</string>\n");
  xml2.append("					<cohort class=\"org.openmrs.reporting.PatientSearch\">\n");
  xml2.append("						<specification>[Male]</specification>\n");
  xml2.append("					</cohort>\n");
  xml2.append("				</entry>\n");
  xml2.append("				<entry>\n");
  xml2.append("					<string>1.b</string>\n");
  xml2.append("					<cohort class=\"org.openmrs.reporting.PatientSearch\">\n");
  xml2.append("						<specification>[Male] and [Adult]</specification>\n");
  xml2.append("					</cohort>\n");
  xml2.append("				</entry>\n");
  xml2.append("				<entry>\n");
  xml2.append("					<string>1.c</string>\n");
  xml2.append("					<cohort class=\"org.openmrs.reporting.PatientSearch\">\n");
  xml2.append("						<specification>[Adult]</specification>\n");
  xml2.append("					</cohort>\n");
  xml2.append("				</entry>\n");
  xml2.append("			</strategies>\n");
  xml2.append("		</dataSetDefinition>\n");
  xml2.append("	</dataSets>\n");
  xml2.append("</reportSchema>\n");
  reportSchemaXmlFromDB.setXml(xml2.toString());
  String newName="PEPFAR report updated";
  String newDescription="Sample monthly PEPFAR report changed again";
  reportSchemaXmlFromDB.setName(newName);
  reportSchemaXmlFromDB.setDescription(newDescription);
  rs.updateReportSchemaXml(reportSchemaXmlFromDB);
  ReportSchemaXml reportSchemaXmlUpdateFromDB=rs.getReportSchemaXml(reportSchemaXmlFromDB.getReportSchemaId());
  assertEquals(xml2.toString(),reportSchemaXmlUpdateFromDB.getXml());
  assertEquals(newName,reportSchemaXmlUpdateFromDB.getName());
  assertEquals(newDescription,reportSchemaXmlUpdateFromDB.getDescription());
}
