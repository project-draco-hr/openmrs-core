{
  if (isAuthenticated()) {
    if (getAuthenticatedUser().hasPrivilege(privilege))     return true;
    if (getAuthenticatedRole().hasPrivilege(privilege))     return true;
  }
  log.debug("Checking '" + privilege + "' against proxies: "+ proxies);
  for (  String s : proxies)   if (s.equals(privilege))   return true;
  if (getAnonymousRole().hasPrivilege(privilege))   return true;
  return false;
}
