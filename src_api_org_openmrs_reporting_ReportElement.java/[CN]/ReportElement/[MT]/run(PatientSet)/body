{
  PatientDataTable patientTable=new PatientDataTable(ps);
  List<Integer> patientIds=new ArrayList<Integer>(patientTable.keySet());
  for (  Map.Entry<String,PatientDataProducer> e : producers.entrySet()) {
    patientTable.addColumn(e.getKey(),e.getValue().produceData(patientIds));
  }
  DataTable table=patientTable.toDataTable();
  for (  TableGroupAndAggregate tga : groupAndAggregate)   table=tga.run(table);
  return table;
}
