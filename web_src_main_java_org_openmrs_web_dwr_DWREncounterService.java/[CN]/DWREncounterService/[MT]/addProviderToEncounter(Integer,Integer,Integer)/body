{
  if (encounterId == null)   throw new APIException(Context.getMessageSourceService().getMessage("Encounter.error.encounterIdCannotBeNull"));
  EncounterService encounterService=Context.getEncounterService();
  Encounter encounter=encounterService.getEncounter(encounterId);
  if (encounter == null)   throw new APIException(Context.getMessageSourceService().getMessage("Encounter.noMatchesFound",new Object[]{encounterId},Context.getLocale()));
  Provider provider=Context.getProviderService().getProvider(providerId);
  EncounterRole encounterRole=encounterService.getEncounterRole(encounterRoleId);
  if (encounter.getProvidersByRole(encounterRole).contains(provider))   throw new APIException(Context.getMessageSourceService().getMessage("Encounter.error.duplicateProviderEncounterRole"));
  encounter.addProvider(encounterRole,provider);
  encounterService.saveEncounter(encounter);
  return encounter == null ? null : new ProviderListItem(provider);
}
