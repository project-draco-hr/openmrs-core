{
  Enumeration entries;
  ZipFile zipFile=null;
  boolean successfullyAdded=true;
  try {
    File moduleRepository=OpenmrsUtil.getDirectoryInApplicationDataDirectory(ModuleConstants.REPOSITORY_FOLDER_PROPERTY_DEFAULT);
    zipFile=new ZipFile(testModulesZipFile);
    entries=zipFile.entries();
    while (entries.hasMoreElements()) {
      ZipEntry entry=(ZipEntry)entries.nextElement();
      if (entry.isDirectory()) {
        log.debug("Skipping directory: " + entry.getName());
        continue;
      }
      String fileName=entry.getName();
      if (fileName.endsWith(".omod")) {
        if (fileName.contains(System.getProperty("file.separator")))         fileName=new File(entry.getName()).getName();
        log.info("Extracting module file: " + fileName);
        OpenmrsUtil.copyFile(zipFile.getInputStream(entry),new BufferedOutputStream(new FileOutputStream(new File(moduleRepository,fileName))));
      }
 else       log.debug("Ignoring file that is not a .omod '" + fileName);
    }
  }
 catch (  IOException e) {
    log.error("An error occured while copying modules to the test server:",e);
    successfullyAdded=false;
  }
 finally {
    if (zipFile != null) {
      try {
        zipFile.close();
      }
 catch (      IOException e) {
        log.error("Failed to close zip file: ",e);
      }
    }
  }
  return successfullyAdded;
}
