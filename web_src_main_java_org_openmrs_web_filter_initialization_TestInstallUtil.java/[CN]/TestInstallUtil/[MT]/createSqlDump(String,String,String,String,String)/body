{
  Process proc=null;
  BufferedReader br=null;
  String errorMsg=null;
  String[] command=new String[]{"mysqldump","--host=" + host,"--port=" + port,"--user=" + user,"--password=" + pwd,"--result-file=" + SQL_DUMP_FILE.getAbsolutePath(),"--skip-extended-insert","--skip-quick","--skip-comments","--skip-add-drop-table","--default-character-set=utf8",databaseName};
  try {
    proc=Runtime.getRuntime().exec(command);
    try {
      br=new BufferedReader(new InputStreamReader(proc.getErrorStream()));
      String line;
      StringBuffer sb=new StringBuffer();
      while ((line=br.readLine()) != null) {
        sb.append(line);
        sb.append(System.getProperty("line.separator"));
      }
      errorMsg=sb.toString();
    }
 catch (    IOException e) {
      log.error("error",e);
    }
 finally {
      if (br != null) {
        try {
          br.close();
        }
 catch (        Exception e) {
          log.error("error: ",e);
        }
      }
    }
    if (StringUtils.isNotBlank(errorMsg))     log.error(errorMsg);
    if (proc.waitFor() == 0) {
      if (log.isDebugEnabled())       log.debug("The sql dump file was created successfully");
      return true;
    }
    log.error("The process terminated abnormally while creating the sql dump");
  }
 catch (  IOException e) {
    log.error("Failed to create the sql dump",e);
  }
catch (  InterruptedException e) {
    log.error("The back up was interrupted while creating the sql dump",e);
  }
  return false;
}
