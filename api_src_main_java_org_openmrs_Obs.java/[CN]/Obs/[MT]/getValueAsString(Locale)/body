{
  NumberFormat nf=NumberFormat.getNumberInstance(locale);
  DecimalFormat df=(DecimalFormat)nf;
  df.applyPattern("#0.0#####");
  if (getConcept() != null) {
    String abbrev=getConcept().getDatatype().getHl7Abbreviation();
    if (abbrev.equals("BIT"))     return getValueAsBoolean() == null ? "" : getValueAsBoolean().toString();
 else     if (abbrev.equals("CWE")) {
      if (getValueCoded() == null)       return "";
      if (getValueDrug() != null)       return getValueDrug().getFullName(locale);
 else {
        ConceptName valueCodedName=getValueCodedName();
        if (valueCodedName != null) {
          return valueCodedName.getName();
        }
 else {
          ConceptName fallbackName=getValueCoded().getName();
          if (fallbackName != null) {
            return fallbackName.getName();
          }
 else {
            return "";
          }
        }
      }
    }
 else     if (abbrev.equals("NM") || abbrev.equals("SN")) {
      if (getValueNumeric() == null) {
        return "";
      }
 else {
        if (getConcept() instanceof ConceptNumeric) {
          ConceptNumeric cn=(ConceptNumeric)getConcept();
          if (cn.isPrecise() != true) {
            double d=getValueNumeric();
            int i=(int)d;
            return Integer.toString(i);
          }
 else {
            df.format(getValueNumeric());
          }
        }
      }
    }
 else     if (abbrev.equals("DT"))     return (getValueDatetime() == null ? "" : Format.format(getValueDatetime(),locale,FORMAT_TYPE.DATE));
 else     if (abbrev.equals("TM"))     return (getValueDatetime() == null ? "" : Format.format(getValueDatetime(),locale,FORMAT_TYPE.TIME));
 else     if (abbrev.equals("TS"))     return (getValueDatetime() == null ? "" : Format.format(getValueDatetime(),locale,FORMAT_TYPE.TIMESTAMP));
 else     if (abbrev.equals("ST"))     return getValueText();
 else     if (abbrev.equals("ED") && getValueComplex() != null) {
      String[] valueComplex=getValueComplex().split("\\|");
      for (int i=0; i < valueComplex.length; i++) {
        if (!"".equals(valueComplex[i])) {
          return valueComplex[i].trim();
        }
      }
    }
  }
  if (getValueNumeric() != null)   return df.format(getValueNumeric());
 else   if (getValueCoded() != null) {
    if (getValueDrug() != null)     return getValueDrug().getFullName(locale);
 else {
      ConceptName valudeCodedName=getValueCodedName();
      if (valudeCodedName != null) {
        return valudeCodedName.getName();
      }
 else {
        return "";
      }
    }
  }
 else   if (getValueDatetime() != null)   return Format.format(getValueDatetime(),locale,FORMAT_TYPE.DATE);
 else   if (getValueText() != null)   return getValueText();
 else   if (hasGroupMembers()) {
    StringBuilder sb=new StringBuilder();
    for (    Obs groupMember : getGroupMembers()) {
      if (sb.length() > 0)       sb.append(", ");
      sb.append(groupMember.getValueAsString(locale));
    }
    return sb.toString();
  }
  if (getValueComplex() != null) {
    String[] valueComplex=getValueComplex().split("\\|");
    for (int i=0; i < valueComplex.length; i++) {
      if (!"".equals(valueComplex[i])) {
        return valueComplex[i].trim();
      }
    }
  }
  return "";
}
