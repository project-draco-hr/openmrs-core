{
  String key=ServletRequestUtils.getStringParameter(request,"indicator","empty");
  if (null == key || "empty".equals(key)) {
    Person p=new Person();
    p.setPersonId(-1);
    return p;
  }
  ReportData report=(ReportData)request.getSession().getAttribute(WebConstants.OPENMRS_REPORT_DATA);
  ArrayList<DataSet> cohortDataSets=new ArrayList<DataSet>();
  Map<String,DataSet> dataSetMap=report.getDataSets();
  cohortDataSets.addAll(dataSetMap.values());
  Iterator<Map<String,Cohort>> iterator=cohortDataSets.get(0).iterator();
  Cohort cohort=null;
  while (iterator.hasNext()) {
    Map<String,Cohort> cohortData=iterator.next();
    if (cohortData.containsKey(key)) {
      cohort=cohortData.get(key);
    }
  }
  Set<Integer> ids=cohort.getMemberIds();
  String personIds=ids.toString();
  personIds=personIds.replaceAll("\\[","");
  personIds=personIds.replaceAll("\\]","");
  personIds=personIds.replaceAll(", ",",");
  personIds=personIds.trim();
  request.setAttribute("patientIds",personIds);
  return report;
}
