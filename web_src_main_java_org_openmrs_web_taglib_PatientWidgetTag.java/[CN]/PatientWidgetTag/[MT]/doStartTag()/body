{
  boolean showNames="full".equals(size);
  boolean showPatientInfo=!"compact".equals(size);
  Patient patient=null;
  if (showPatientInfo) {
    patient=Context.getPatientService().getPatient(patientId);
  }
  try {
    JspWriter w=pageContext.getOut();
    if (showNames && patient != null) {
      w.print(patient.getNames().iterator().next());
    }
 else {
      w.print("patient_id " + patientId);
    }
    if (showPatientInfo) {
      if (patient.getGender() != null) {
        String s=patient.getGender().toLowerCase().startsWith("m") ? "Male" : "Female";
        w.print(", " + s);
      }
      if (patient.getAge() != null) {
        w.print(", " + patient.getAge() + " year(s) old");
      }
    }
  }
 catch (  IOException ex) {
    log.error("Error while starting patientWidget tag",ex);
  }
  return SKIP_BODY;
}
