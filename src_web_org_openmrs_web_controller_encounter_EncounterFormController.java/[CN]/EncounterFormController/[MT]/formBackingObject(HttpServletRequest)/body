{
  HttpSession httpSession=request.getSession();
  Context context=(Context)httpSession.getAttribute(WebConstants.OPENMRS_CONTEXT_HTTPSESSION_ATTR);
  Encounter encounter=null;
  if (context != null && context.isAuthenticated()) {
    EncounterService es=context.getEncounterService();
    String encounterId=request.getParameter("encounterId");
    if (encounterId != null) {
      encounter=es.getEncounter(Integer.valueOf(encounterId));
    }
  }
  if (encounter == null)   encounter=new Encounter();
  return encounter;
}
