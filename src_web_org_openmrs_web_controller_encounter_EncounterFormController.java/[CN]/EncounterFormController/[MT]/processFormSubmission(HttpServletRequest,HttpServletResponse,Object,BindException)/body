{
  Encounter encounter=(Encounter)obj;
  Context.addProxyPrivilege(OpenmrsConstants.PRIV_VIEW_USERS);
  Context.addProxyPrivilege(OpenmrsConstants.PRIV_VIEW_PATIENTS);
  try {
    if (Context.isAuthenticated()) {
      if (request.getParameter("patientId") != null)       encounter.setPatient(Context.getPatientService().getPatient(Integer.valueOf(request.getParameter("patientId"))));
      if (request.getParameter("providerId") != null)       encounter.setProvider(Context.getUserService().getUser(Integer.valueOf(request.getParameter("providerId"))));
      if (encounter.isVoided())       ValidationUtils.rejectIfEmptyOrWhitespace(errors,"voidReason","error.null");
    }
  }
  finally {
    Context.removeProxyPrivilege(OpenmrsConstants.PRIV_VIEW_USERS);
    Context.removeProxyPrivilege(OpenmrsConstants.PRIV_VIEW_PATIENTS);
  }
  return super.processFormSubmission(request,reponse,encounter,errors);
}
