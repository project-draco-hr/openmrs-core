{
  UserContext userContext=Context.getUserContext();
  log.debug("Checking user " + userContext.getAuthenticatedUser() + " for privs "+ privilege);
  boolean hasPrivilege=false;
  if (privilege.contains(",")) {
    String[] privs=privilege.split(",");
    for (    String p : privs) {
      if (userContext.hasPrivilege(p)) {
        hasPrivilege=true;
        break;
      }
    }
  }
 else {
    hasPrivilege=userContext.hasPrivilege(privilege);
  }
  boolean isInverted=false;
  if (inverse != null) {
    isInverted="true".equals(inverse.toLowerCase());
  }
  if ((hasPrivilege && !isInverted) || (!hasPrivilege && isInverted)) {
    pageContext.setAttribute("authenticatedUser",userContext.getAuthenticatedUser());
    return EVAL_BODY_INCLUDE;
  }
 else {
    return SKIP_BODY;
  }
}
