{
  int num=3;
  executeDataSet("org/openmrs/web/taglib/include/ForEachEncounterTagTest.xml");
  Patient patient=Context.getPatientService().getPatient(7);
  List<Encounter> encounters=Context.getEncounterService().getEncountersByPatient(patient);
  ForEachEncounterTag tag=new ForEachEncounterTag();
  tag.setPageContext(new MockPageContext());
  tag.setDescending(true);
  tag.setEncounters(encounters);
  tag.setVar("enc");
  tag.setNum(num);
  Assert.assertEquals(BodyTag.EVAL_BODY_BUFFERED,tag.doStartTag());
  Assert.assertTrue(num >= tag.matchingEncs.size());
  Assert.assertEquals(11,tag.matchingEncs.get(0).getId().intValue());
  Assert.assertEquals(16,tag.matchingEncs.get(1).getId().intValue());
  Assert.assertEquals(7,tag.matchingEncs.get(2).getId().intValue());
}
