{
  final DrugOrder orderToDiscontinue=(DrugOrder)orderService.getOrder(5);
  Drug discontinuationOrderDrug=new Drug();
  discontinuationOrderDrug.setConcept(orderToDiscontinue.getConcept());
  discontinuationOrderDrug=conceptService.saveDrug(discontinuationOrderDrug);
  assertNotEquals(discontinuationOrderDrug,orderToDiscontinue.getDrug());
  assertNotNull(orderToDiscontinue.getDrug());
  DrugOrder order=orderToDiscontinue.cloneForRevision();
  order.setStartDate(new Date());
  order.setOrderer(providerService.getProvider(1));
  order.setEncounter(encounterService.getEncounter(6));
  order.setDrug(discontinuationOrderDrug);
  expectedException.expect(APIException.class);
  expectedException.expectMessage("The drug of the previous order and the new one order don't match");
  orderService.saveOrder(order,null);
}
