{
  executeDataSet("org/openmrs/api/include/OrderServiceTest-reviseActiveOrders.xml");
  Order order=orderService.getOrder(16);
  DrugOrder reviseOrder=(DrugOrder)order.cloneForRevision();
  reviseOrder.setDose((double)200);
  reviseOrder.setDoseUnits(conceptService.getConcept(51));
  reviseOrder.setFrequency(orderService.getOrderFrequency(2));
  reviseOrder.setAsNeeded(false);
  reviseOrder.setDosingType(DrugOrder.DosingType.FREE_TEXT);
  reviseOrder.setDateCreated(new Date());
  reviseOrder.setDuration((double)10);
  reviseOrder.setAutoExpireDate(dateAfterDays(10));
  Integer revisedOrderId=orderService.saveRevisedOrder(reviseOrder).getOrderId();
  DrugOrder savedRevisedOrder=(DrugOrder)orderService.getOrder(revisedOrderId);
  assertEquals(new Integer(16),savedRevisedOrder.getPreviousOrder().getOrderId());
  assertEquals(new Date().toString(),savedRevisedOrder.getPreviousOrder().getDateStopped().toString());
  assertEquals(Action.REVISE,savedRevisedOrder.getAction());
  assertEquals(new Double(200),savedRevisedOrder.getDose());
  assertEquals(new Integer(51),savedRevisedOrder.getDoseUnits().getConceptId());
  assertFalse(savedRevisedOrder.getAsNeeded());
  assertEquals(DrugOrder.DosingType.FREE_TEXT,savedRevisedOrder.getDosingType());
  assertNotEquals(order.getOrderNumber(),savedRevisedOrder.getOrderNumber());
}
