{
  Vector locationList=new Vector();
  HttpServletRequest request=WebContextFactory.get().getHttpServletRequest();
  Context context=(Context)request.getSession().getAttribute(WebConstants.OPENMRS_CONTEXT_HTTPSESSION_ATTR);
  if (context == null) {
    locationList.add("Your session has expired.");
    locationList.add("Please <a href='" + request.getContextPath() + "/logout'>log in</a> again.");
  }
 else {
    try {
      FormEntryService fs=context.getFormEntryService();
      List<Location> locations=fs.findLocations(searchValue);
      locationList=new Vector(locations.size());
      for (      Location loc : locations) {
        locationList.add(new LocationListItem(loc));
      }
    }
 catch (    Exception e) {
      log.error(e);
      locationList.add("Error while attempting to find locations - " + e.getMessage());
    }
    if (locationList.size() == 0) {
      locationList.add("No locations found. Please search again.");
    }
  }
  return locationList;
}
