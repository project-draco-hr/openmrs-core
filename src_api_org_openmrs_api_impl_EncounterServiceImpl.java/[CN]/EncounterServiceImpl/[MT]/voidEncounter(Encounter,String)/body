{
  if (!Context.hasPrivilege(OpenmrsConstants.PRIV_EDIT_ENCOUNTERS))   throw new APIAuthenticationException("Privilege required: " + OpenmrsConstants.PRIV_EDIT_ENCOUNTERS);
  if (reason == null)   reason="";
  ObsService os=Context.getObsService();
  for (  Obs o : encounter.getObs()) {
    if (!o.isVoided()) {
      os.voidObs(o,reason);
    }
  }
  encounter.setVoided(true);
  encounter.setVoidedBy(Context.getAuthenticatedUser());
  encounter.setDateVoided(new Date());
  encounter.setVoidReason(reason);
  updateEncounter(encounter);
}
