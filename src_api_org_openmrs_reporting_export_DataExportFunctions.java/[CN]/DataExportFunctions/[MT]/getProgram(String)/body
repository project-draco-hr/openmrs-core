{
  Map<Integer,PatientProgram> patientIdProgramMap;
  if (programMap.containsKey(programName)) {
    patientIdProgramMap=programMap.get(programName);
  }
 else {
    Program program=Context.getProgramWorkflowService().getProgram(programName);
    patientIdProgramMap=patientSetService.getPatientPrograms(getPatientSetIfNotAllPatients(),program);
    programMap.put(programName,patientIdProgramMap);
  }
  return patientIdProgramMap.get(patientId);
}
