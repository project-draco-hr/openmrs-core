{
  if (cohortMap.containsKey(key))   return cohortMap.get(key).contains(getPatientId());
  log.debug("getting cohort/definition for key: " + key);
  PatientSet ps=null;
  if (key.startsWith("C.")) {
    Cohort c=Context.getCohortService().getCohort(Integer.valueOf(key.substring(2)));
    ps=c.toPatientSet();
  }
 else   if (key.startsWith("F.")) {
    PatientFilter pf=Context.getReportService().getPatientFilterById(Integer.valueOf(key.substring(2)));
    ps=pf.filter(getPatientSet());
  }
 else   if (key.startsWith("S.")) {
    PatientSearchReportObject ro=(PatientSearchReportObject)Context.getReportService().getReportObject(Integer.valueOf(key.substring(2)));
    PatientFilter pf=OpenmrsUtil.toPatientFilter(ro.getPatientSearch(),null);
    ps=pf.filter(getPatientSet());
  }
 else {
    log.error("key = " + key);
  }
  Set<Integer> set=new HashSet<Integer>(ps.getPatientIds());
  cohortMap.put(key,set);
  return set.contains(getPatientId());
}
