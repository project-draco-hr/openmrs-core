{
  Vector<PersonListItem> personList=new Vector<PersonListItem>();
  if (roles != null)   roles=roles.trim();
  if (roles != null && roles.length() > 0) {
    UserService us=Context.getUserService();
    List<Role> roleList=new Vector<Role>();
    if (roles != null)     if (roles.length() > 0) {
      String[] splitRoles=roles.split(",");
      for (      String role : splitRoles) {
        roleList.add(new Role(role));
      }
    }
    for (    Person p : us.getUsers(searchPhrase,roleList,includeVoided)) {
      personList.add(PersonListItem.createBestMatch(p));
    }
  }
 else {
    PersonService ps=Context.getPersonService();
    for (    Person p : ps.getPeople(searchPhrase,null)) {
      personList.add(PersonListItem.createBestMatch(p));
    }
    if (searchPhrase.matches(".*\\d+.*")) {
      PatientService patientService=Context.getPatientService();
      for (      Patient p : patientService.getPatients(null,searchPhrase,null,false)) {
        personList.add(PersonListItem.createBestMatch(p));
      }
    }
  }
  return personList;
}
