{
  if (ignoreRequiredModules())   return;
  Map<String,String> requiredModules=new HashMap<String,String>(ModuleConstants.REQUIRED_MODULES);
  Collection<Module> startedModules=ModuleFactory.getStartedModulesMap().values();
  for (  Module mod : startedModules) {
    String moduleId=mod.getModuleId();
    if (requiredModules.containsKey(moduleId)) {
      String reqVersion=requiredModules.get(moduleId);
      if (compareVersion(mod.getVersion(),reqVersion) >= 0)       requiredModules.remove(moduleId);
 else       log.debug("Module: " + moduleId + " is started, but its version: "+ mod.getVersion()+ " is not within the required version: "+ reqVersion);
    }
  }
  if (requiredModules.size() > 0) {
    throw new OpenmrsRequiredModuleException(requiredModules);
  }
}
