{
  HttpSession httpSession=request.getSession();
  Context context=(Context)httpSession.getAttribute(WebConstants.OPENMRS_CONTEXT_HTTPSESSION_ATTR);
  if (context == null) {
    httpSession.setAttribute(WebConstants.OPENMRS_ERROR_ATTR,"auth.session.expired");
    response.sendRedirect(request.getContextPath() + "/logout");
    return null;
  }
  String message=request.getParameter("message");
  if (message == null || message.length() == 0) {
    message="Paste some xml";
  }
  EncounterService es=context.getEncounterService();
  List<Location> locations=es.getLocations();
  UserService us=context.getUserService();
  List<User> users=us.getUsers();
  Map myModel=new HashMap();
  myModel.put("message",message);
  myModel.put("locations",locations);
  myModel.put("users",users);
  return new ModelAndView("/migration/migration","model",myModel);
}
