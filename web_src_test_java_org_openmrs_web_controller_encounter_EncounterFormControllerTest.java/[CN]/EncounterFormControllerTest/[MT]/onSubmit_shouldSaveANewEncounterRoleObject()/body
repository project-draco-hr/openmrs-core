{
  executeDataSet(ENC_INITIAL_DATA_XML);
  executeDataSet(TRANSFER_ENC_DATA_XML);
  EncounterFormController controller=new EncounterFormController();
  MockHttpServletResponse response=new MockHttpServletResponse();
  MockHttpServletRequest request=new MockHttpServletRequest();
  request.setParameter("patientId","201");
  Encounter encounter=Context.getEncounterService().getEncounter(200);
  Patient oldPatient=encounter.getPatient();
  Patient newPatient=Context.getPatientService().getPatient(201);
  Assert.assertNotEquals(oldPatient,newPatient);
  List<Encounter> newEncounter=Context.getEncounterService().getEncountersByPatientId(newPatient.getPatientId());
  Assert.assertEquals(0,newEncounter.size());
  BindException errors=new BindException(encounter,"encounterRole");
  controller.onSubmit(request,response,encounter,errors);
  Assert.assertEquals(true,encounter.isVoided());
  newEncounter=Context.getEncounterService().getEncountersByPatientId(newPatient.getPatientId());
  Assert.assertEquals(1,newEncounter.size());
  Assert.assertEquals(false,newEncounter.get(0).isVoided());
}
