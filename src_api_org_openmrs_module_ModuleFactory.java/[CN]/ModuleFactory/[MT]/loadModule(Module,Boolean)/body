{
  log.debug("Adding module " + module.getName() + " to the module queue");
  Module oldModule=getLoadedModulesMap().get(module.getModuleId());
  if (oldModule != null) {
    if (replaceIfExists == true) {
      unloadModule(oldModule);
    }
 else     throw new ModuleException("A module with the same id already exists",module.getModuleId());
  }
  getLoadedModulesMap().put(module.getModuleId(),module);
  return module;
}
