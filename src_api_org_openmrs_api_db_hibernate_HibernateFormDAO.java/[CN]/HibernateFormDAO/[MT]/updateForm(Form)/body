{
  if (form.isRetired() && form.getRetiredBy() == null) {
    retireForm(form,form.getRetiredReason());
  }
 else   if (!form.isRetired() && form.getRetiredBy() != null) {
    unretireForm(form);
  }
 else {
    if (form.getFormId() == null)     createForm(form);
 else {
      Session session=HibernateUtil.currentSession();
      updateFormProperties(form);
      try {
        HibernateUtil.beginTransaction();
        session.saveOrUpdate(form);
        HibernateUtil.commitTransaction();
      }
 catch (      Exception e) {
        HibernateUtil.rollbackTransaction();
        throw new DAOException(e);
      }
    }
  }
}
