{
  Map<List<Object>,List<DataRow>> map=new HashMap<List<Object>,List<DataRow>>();
  for (  DataRow row : input.getRows()) {
    List<Object> key=new ArrayList<Object>();
    for (    String columnName : columnNames) {
      key.add(row.get(columnName));
    }
    List<DataRow> list=map.get(key);
    if (list == null) {
      list=new ArrayList<DataRow>();
      map.put(key,list);
    }
    list.add(row);
  }
  DataTable output=new SimpleDataTable();
  for (  List<DataRow> list : map.values()) {
    DataRow row=aggregator.aggregate(list,columnNameForAggregation,columnNames);
    output.addRow(row);
  }
  return output;
}
