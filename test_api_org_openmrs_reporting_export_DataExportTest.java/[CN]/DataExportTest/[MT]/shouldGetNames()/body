{
  executeDataSet("org/openmrs/reporting/export/include/DataExportTest-patients.xml");
  DataExportReportObject export=new DataExportReportObject();
  export.setName("Given names export");
  export.addSimpleColumn("PATIENT_ID","$!{fn.patientId}");
  export.addSimpleColumn("Name","$!{fn.getPatientAttr('PersonName', 'givenName')}");
  Cohort patients=new Cohort();
  patients.addMember(2);
  DataExportUtil.generateExport(export,patients,"\t",null);
  File exportFile=DataExportUtil.getGeneratedFile(export);
  String expectedOutput="PATIENT_ID	Name\n2	John\n";
  String output=OpenmrsUtil.getFileAsString(exportFile);
  exportFile.delete();
  assertEquals("The output is not right.",expectedOutput,output);
}
