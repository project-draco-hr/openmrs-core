{
  Collection<Map<String,Object>> log=new Vector<Map<String,Object>>();
  try {
    Map<String,Object> row;
    String sql="select * from `";
    sql+=OpenmrsConstants.DATABASE_BUSINESS_NAME + "`.ext_mrn_log ";
    sql+="order by mrn_log_id desc";
    PreparedStatement ps=sessionFactory.getCurrentSession().connection().prepareStatement(sql);
    ResultSet rs=ps.executeQuery();
    while (rs.next()) {
      row=new HashMap<String,Object>();
      row.put("date",rs.getTimestamp("date_generated"));
      row.put("user",rs.getString("generated_by"));
      row.put("site",rs.getString("site"));
      row.put("first",rs.getInt("mrn_first"));
      row.put("count",rs.getInt("mrn_count"));
      log.add(row);
    }
  }
 catch (  Exception e) {
    throw new DAOException("Error getting mrn log",e);
  }
  return log;
}
