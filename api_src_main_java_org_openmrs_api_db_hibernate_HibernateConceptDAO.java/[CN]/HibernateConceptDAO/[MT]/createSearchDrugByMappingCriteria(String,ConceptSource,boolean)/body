{
  Criteria searchCriteria=sessionFactory.getCurrentSession().createCriteria(Drug.class);
  searchCriteria.createAlias("drugReferenceMaps","map");
  searchCriteria.createAlias("map.conceptReferenceTerm","term");
  if (code != null) {
    searchCriteria.add(Restrictions.eq("term.code",code));
  }
  if (conceptSource != null) {
    searchCriteria.add(Restrictions.eq("term.conceptSource",conceptSource));
  }
  if (!includeRetired) {
    searchCriteria.add(Restrictions.eq("retired",false));
  }
  return searchCriteria;
}
