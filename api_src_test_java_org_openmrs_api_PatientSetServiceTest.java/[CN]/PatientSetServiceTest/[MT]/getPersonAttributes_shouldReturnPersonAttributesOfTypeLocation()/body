{
  executeDataSet(EXTRA_DATA_XML);
  Cohort c=service.getAllPatients();
  String attributeName="Health Center";
  String joinClass="Location";
  String joinProperty="locationId";
  String outputColumn="name";
  boolean returnAll=false;
  Map<Integer,Object> ret=service.getPersonAttributes(c,attributeName,joinClass,joinProperty,outputColumn,returnAll);
  Assert.assertEquals(4,ret.size());
  Assert.assertEquals("Unknown Location",ret.get(2));
  Assert.assertEquals("Xanadu",ret.get(6));
  Assert.assertEquals("Xanadu",ret.get(7));
  Assert.assertEquals("Xanadu",ret.get(8));
}
