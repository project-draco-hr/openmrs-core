{
  DateFormat ymd=new SimpleDateFormat("yyyy-MM-dd");
  Concept testConcept=Context.getConceptService().getConcept(18);
  Obs obs1=new Obs();
  obs1.setPerson(new Person(8));
  obs1.setConcept(testConcept);
  obs1.setObsDatetime(ymd.parse("2007-01-01"));
  obs1.setValueBoolean(true);
  obs1.setValueDatetime(ymd.parse("2007-01-01"));
  Context.getObsService().saveObs(obs1,null);
  Obs obs2=new Obs();
  obs2.setPerson(new Person(7));
  obs2.setConcept(testConcept);
  obs2.setObsDatetime(ymd.parse("2007-01-03"));
  obs2.setValueBoolean(true);
  obs2.setValueDatetime(ymd.parse("2007-01-03"));
  Context.getObsService().saveObs(obs2,null);
  Cohort cohort=service.getPatientsHavingDateObs(18,ymd.parse("2006-12-31"),ymd.parse("2007-01-03"));
  Map<Integer,List<Obs>> result=service.getObservations(cohort,testConcept);
  assertEquals(2,result.size());
  assertTrue(result.containsKey(8));
  assertTrue(result.get(8).contains(obs1));
  assertTrue(result.containsKey(7));
  assertTrue(result.get(7).contains(obs2));
}
