{
  Set<Object> propertyNames=macros.keySet();
  if (StringUtils.hasText(xml)) {
    while (true) {
      String replacementXml=xml;
      for (      Object propName : propertyNames) {
        System.out.println("Trying to replace @" + propName.toString() + "@ with "+ macros.getProperty(propName.toString()));
        replacementXml=replacementXml.replace("@" + propName.toString() + "@",macros.getProperty(propName.toString()));
      }
      if (replacementXml.equals(xml)) {
        break;
      }
      xml=replacementXml;
    }
  }
  return xml;
}
