{
  if (!Context.getUserContext().hasPrivilege(OpenmrsConstants.PRIV_VIEW_PROGRAMS))   throw new APIAuthenticationException("Privilege required: " + OpenmrsConstants.PRIV_VIEW_PROGRAMS);
  List<ProgramWorkflowState> ret=new ArrayList<ProgramWorkflowState>();
  PatientState currentState=getLatestState(patientProgram,workflow);
  for (  ProgramWorkflowState st : workflow.getSortedStates()) {
    if (isLegalTransition(currentState == null ? null : currentState.getState(),st))     ret.add(st);
  }
  return ret;
}
