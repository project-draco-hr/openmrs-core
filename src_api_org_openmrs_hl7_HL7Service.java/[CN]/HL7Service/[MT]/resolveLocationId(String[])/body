{
  String pointOfCare=pl[0];
  String facility=null;
  if (pl.length >= 4) {
    facility=pl[3];
  }
  try {
    Integer locationId=new Integer(pointOfCare);
    Location l=context.getEncounterService().getLocation(locationId);
    return l == null ? null : l.getLocationId();
  }
 catch (  Exception ex) {
    if (facility == null) {
      throw new HL7Exception("Error trying to treat PL.pointOfCare '" + pointOfCare + "' as a location.location_id",ex);
    }
  }
  try {
    Location l=context.getEncounterService().getLocationByName(facility);
    if (l == null) {
      log.debug("Couldn't find a location named '" + facility + "'");
    }
    return l == null ? null : l.getLocationId();
  }
 catch (  Exception ex) {
    log.error("Error trying to treat PL.facility '" + facility + "' as a location.name",ex);
    return null;
  }
}
