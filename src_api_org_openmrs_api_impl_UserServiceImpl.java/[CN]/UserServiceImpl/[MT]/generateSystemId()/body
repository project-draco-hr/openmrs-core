{
  String systemId;
  Integer checkDigit;
  Integer offset=0;
  do {
    Integer generatedId=getUserDAO().generateSystemId() + offset++;
    systemId=generatedId.toString();
    try {
      checkDigit=OpenmrsUtil.getCheckDigit(systemId);
    }
 catch (    Exception e) {
      log.error("error getting check digit",e);
      return systemId;
    }
    systemId=systemId + "-" + checkDigit;
  }
 while (getUserDAO().hasDuplicateUsername(null,systemId,null));
  return systemId;
}
