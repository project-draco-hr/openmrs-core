{
  String formName="";
  String xml="no xml!";
  try {
    DocumentBuilder db=dbf.newDocumentBuilder();
    xml=IOUtils.toString(request.getInputStream());
    Document doc=db.parse(IOUtils.toInputStream(xml));
    NodeList formElemList=doc.getElementsByTagName("form");
    if (formElemList != null && formElemList.getLength() > 0) {
      Element formElem=(Element)formElemList.item(0);
      formName=formElem.getAttribute("name");
    }
  }
 catch (  ParserConfigurationException e) {
    log.error("Error parsing form data",e);
  }
catch (  SAXException e) {
    log.error("Error parsing form data",e);
  }
catch (  IOException e) {
    log.error("Error parsing form data",e);
  }
  FormEntryQueue formEntryQueue=new FormEntryQueue();
  formEntryQueue.setFormData(xml);
  Context context=(Context)request.getSession().getAttribute(WebConstants.OPENMRS_CONTEXT_HTTPSESSION_ATTR);
  FormEntryService formEntryService=context.getFormEntryService();
  formEntryService.createFormEntryQueue(formEntryQueue);
  ServletOutputStream out=response.getOutputStream();
  response.setStatus(HttpServletResponse.SC_OK);
  response.setContentType("text/html;charset=utf-8");
  out.println("<html><head><title>FormEntry</title></head>" + "<body><h1>Details (with xml)</h1>" + "<p>form name = \"" + formName + "\"</p>"+ "<p><textarea cols=40 rows=8>"+ xml+ "</textarea></p>"+ "</body></html>");
}
