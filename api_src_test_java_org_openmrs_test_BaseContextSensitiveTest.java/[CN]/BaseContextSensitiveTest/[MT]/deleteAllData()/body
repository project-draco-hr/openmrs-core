{
  Connection connection=getConnection();
  IDatabaseConnection dbUnitConn=new DatabaseConnection(connection);
  if (useInMemoryDatabase()) {
    String sql="SET REFERENTIAL_INTEGRITY FALSE";
    PreparedStatement ps=connection.prepareStatement(sql);
    ps.execute();
    ps.close();
  }
  ResultSet resultSet=connection.getMetaData().getTables(null,"PUBLIC","%",null);
  DefaultDataSet dataset=new DefaultDataSet();
  while (resultSet.next()) {
    String tableName=resultSet.getString(3);
    dataset.addTable(new DefaultTable(tableName));
  }
  if (useInMemoryDatabase())   DatabaseOperation.DELETE_ALL.execute(dbUnitConn,dataset);
  if (useInMemoryDatabase()) {
    String sql="SET REFERENTIAL_INTEGRITY TRUE";
    PreparedStatement ps=connection.prepareStatement(sql);
    ps.execute();
    ps.close();
  }
  Context.clearSession();
  if (Context.isSessionOpen())   Context.refreshAuthenticatedUser();
}
