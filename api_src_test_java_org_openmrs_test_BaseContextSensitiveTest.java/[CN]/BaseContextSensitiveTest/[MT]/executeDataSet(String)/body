{
  IDataSet xmlDataSetToRun=cachedDatasets.get(datasetFilename);
  if (xmlDataSetToRun == null) {
    File file=new File(datasetFilename);
    InputStream fileInInputStreamFormat=null;
    if (file.exists())     fileInInputStreamFormat=new FileInputStream(datasetFilename);
 else {
      fileInInputStreamFormat=getClass().getClassLoader().getResourceAsStream(datasetFilename);
      if (fileInInputStreamFormat == null)       throw new FileNotFoundException("Unable to find '" + datasetFilename + "' in the classpath");
    }
    Reader reader=null;
    try {
      reader=new InputStreamReader(fileInInputStreamFormat);
      ReplacementDataSet replacementDataSet=new ReplacementDataSet(new FlatXmlDataSet(reader,false,true,false));
      replacementDataSet.addReplacementObject("[NULL]",null);
      xmlDataSetToRun=replacementDataSet;
    }
  finally {
      fileInInputStreamFormat.close();
      if (reader != null)       reader.close();
    }
    cachedDatasets.put(datasetFilename,xmlDataSetToRun);
  }
  executeDataSet(xmlDataSetToRun);
}
