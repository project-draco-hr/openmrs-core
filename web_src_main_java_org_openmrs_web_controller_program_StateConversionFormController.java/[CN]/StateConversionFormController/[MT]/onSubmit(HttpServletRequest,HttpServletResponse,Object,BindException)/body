{
  log.debug("about to save " + obj);
  HttpSession httpSession=request.getSession();
  if (Context.isAuthenticated()) {
    ConceptStateConversion c=(ConceptStateConversion)obj;
    boolean isError=false;
    try {
      Context.getProgramWorkflowService().saveConceptStateConversion(c);
    }
 catch (    APIException ae) {
      httpSession.setAttribute(WebConstants.OPENMRS_ERROR_ATTR,"ConceptStateConversion.error.incompleteform");
      isError=true;
      if (c.getConcept() == null) {
        errors.rejectValue("conversion.concept","error.concept");
      }
      if (c.getProgramWorkflow() == null) {
        errors.rejectValue("conversion.programWorkflow","error.programWorkflow");
      }
      if (c.getProgramWorkflowState() == null) {
        errors.rejectValue("conversion.programWorkflowState","error.programWorkflowState");
      }
    }
    if (!isError) {
      String view=getSuccessView();
      httpSession.setAttribute(WebConstants.OPENMRS_MSG_ATTR,"Program.conversion.saved");
      return new ModelAndView(new RedirectView(view));
    }
 else {
      return showForm(request,response,errors);
    }
  }
  return new ModelAndView(new RedirectView(getFormView()));
}
