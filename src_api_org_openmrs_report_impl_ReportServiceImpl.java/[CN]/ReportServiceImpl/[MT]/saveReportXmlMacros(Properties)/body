{
  try {
    ByteArrayOutputStream out=new ByteArrayOutputStream();
    macros.store(out,null);
    GlobalProperty prop=new GlobalProperty(OpenmrsConstants.GLOBAL_PROPERTY_REPORT_XML_MACROS,out.toString());
    Context.getAdministrationService().saveGlobalProperty(prop);
  }
 catch (  Exception ex) {
    throw new APIException(ex);
  }
}
