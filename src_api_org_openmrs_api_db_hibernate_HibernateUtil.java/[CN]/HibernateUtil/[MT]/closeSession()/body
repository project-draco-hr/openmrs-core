{
  if (log.isDebugEnabled() && sessionFactory.getStatistics().isStatisticsEnabled()) {
    log.debug("Session Entity Count: " + currentSession().getStatistics().getEntityCount());
    log.debug("Displaying second level cache stats");
    log.debug("Cache Load count: " + sessionFactory.getStatistics().getEntityLoadCount());
    log.debug("Cache Put count: " + sessionFactory.getStatistics().getSecondLevelCachePutCount());
    log.debug("Cache Hit count: " + sessionFactory.getStatistics().getSecondLevelCacheHitCount());
    log.debug("Cache Miss count: " + sessionFactory.getStatistics().getSecondLevelCacheMissCount());
  }
  log.debug("attempting to close session");
  try {
    commitTransaction();
  }
 catch (  Exception e) {
    log.error(e);
  }
 finally {
    Session s=(Session)threadLocalSession.get();
    if (s != null) {
      log.debug("Closing session");
      s.close();
    }
 else     log.debug("Couldn't close session");
    threadLocalSession.remove();
  }
}
