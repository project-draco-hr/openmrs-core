{
  Connection conn=currentSession().connection();
  try {
    PreparedStatement psSelect=conn.prepareStatement("SELECT * FROM role WHERE UPPER(role) = UPPER(?)");
    PreparedStatement psInsert=conn.prepareStatement("INSERT INTO role VALUES (?, 'Core Role')");
    for (    String role : OpenmrsConstants.CORE_ROLES()) {
      psSelect.setString(1,role);
      ResultSet result=psSelect.executeQuery();
      if (!result.next()) {
        psInsert.setString(1,role);
        psInsert.execute();
      }
    }
    psSelect=conn.prepareStatement("SELECT * FROM privilege WHERE UPPER(privilege) = UPPER(?)");
    psInsert=conn.prepareStatement("INSERT INTO privilege VALUES (?, 'Core Privilege')");
    for (    String priv : OpenmrsConstants.CORE_PRIVILEGES()) {
      psSelect.setString(1,priv);
      ResultSet result=psSelect.executeQuery();
      if (!result.next()) {
        psInsert.setString(1,priv);
        psInsert.execute();
      }
    }
    conn.commit();
  }
 catch (  SQLException e) {
    log.error("Error while setting core dataset",e);
  }
}
