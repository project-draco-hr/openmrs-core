{
  mockServletContext=new MockServletContext();
  DefaultListableBeanFactory dlbf=new DefaultListableBeanFactory(applicationContext.getParentBeanFactory());
  GenericWebApplicationContext webApplicationContext=new GenericWebApplicationContext(dlbf);
  ResourceBundleMessageSource messageSource=new ResourceBundleMessageSource();
  messageSource.setBasename("org/openmrs/web/taglib/messages/test-messages");
  webApplicationContext.setParent(applicationContext);
  mockServletContext.setAttribute(WebApplicationContext.ROOT_WEB_APPLICATION_CONTEXT_ATTRIBUTE,webApplicationContext);
  webApplicationContext.refresh();
  mockPageContext=new MockPageContext(mockServletContext);
  openmrsMessageTag=new OpenmrsMessageTag();
  openmrsMessageTag.setPageContext(mockPageContext);
}
