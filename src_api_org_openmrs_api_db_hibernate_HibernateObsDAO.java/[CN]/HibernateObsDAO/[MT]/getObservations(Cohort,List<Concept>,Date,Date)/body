{
  Criteria criteria=sessionFactory.getCurrentSession().createCriteria(Obs.class);
  if (patients != null) {
    if (patients.getMemberIds() != null) {
      criteria.add(Restrictions.in("person.personId",patients.getMemberIds()));
    }
  }
  if (concepts != null) {
    criteria.add(Restrictions.in("concept",concepts));
  }
  if (fromDate != null) {
    criteria.add(Restrictions.gt("obsDatetime",fromDate));
  }
  if (toDate != null) {
    criteria.add(Restrictions.lt("obsDatetime",toDate));
  }
  criteria.addOrder(Order.desc("obsDatetime"));
  return (List<Obs>)criteria.list();
}
