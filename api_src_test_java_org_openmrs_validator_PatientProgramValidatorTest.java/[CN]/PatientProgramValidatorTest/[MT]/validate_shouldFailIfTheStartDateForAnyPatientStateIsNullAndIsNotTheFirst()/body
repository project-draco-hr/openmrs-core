{
  PatientProgram program=Context.getProgramWorkflowService().getPatientProgram(1);
  PatientState firstState=program.getStates().iterator().next();
  PatientState newPatientState=new PatientState();
  newPatientState.setState(firstState.getState().getProgramWorkflow().getState(4));
  Assert.assertNotSame(firstState.getState(),newPatientState.getState());
  program.getStates().add(newPatientState);
  BindException errors=new BindException(program,"");
  new PatientProgramValidator().validate(program,errors);
  Assert.assertEquals(true,errors.hasFieldErrors("states"));
}
